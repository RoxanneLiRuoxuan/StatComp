<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ruoxuan Li" />

<meta name="date" content="2021-12-20" />

<title>21020</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">21020</h1>
<h4 class="author">Ruoxuan Li</h4>
<h4 class="date">2021-12-20</h4>



<p>—————————2021-09-23————————————<br />
## Question</p>
<p><br />
Exercises 3.4 3.11 3.20</p>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p><br />
</p>
<p>3.4:利用Inverse transformation method产生随机数，分别设置sigma为1,3,7,10进行比较。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Var<span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">49</span>,<span class="dv">100</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> Var){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>i<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>u)))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(x1,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;var&quot;</span>,i))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">40</span>,<span class="fl">0.1</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(y,y<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>i))<span class="sc">/</span>i)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAmVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZrY6kLY6kNtmAABmADpmOgBmZmZmtttmtv+QOgCQZgCQZjqQkDqQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2kGa22/+2/7a2///T09PbkDrbtpDb27bb29vb/9vb////tmb/25D/27b//7b//9v///8V2Aj2AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJQklEQVR4nO2daUOkNgCGo6vV3jNru9Nb2q3SbcVV//+Paw4YYSS8CSQkwPt8UJwjJI+5E0C8kEFE6gjkDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFARYmKDng7jSv38W4t2Pc5xxYYJKoQU97YXiuxnOuCxBj9dGUCHObmVmEh/inzITQYU4v5O/Kp3mf25k7vj29kVlmLPfbsT5x/pTyokSJDPQlbZ1FT9mmQgyZqSnywd1rDi71SVKIl8zlOLiplaz05qO78QjE0Gm8pVJ3qnDLx5qB1LQ5ceXf+sPVeLsj8OrIPlBne3ikokgqUImttTZRvLpr691WSrb1YzU9+Eo0vzckCCZKVTqVZlRTbgQtaDamKKQr9TNvK6kC7ElQSrlx5IjLn79tD8VVCkdtSDVmik2JEiVsV+0jmMNfCKoEA3y7c834uz7nzZUSdeZQiXYNGhNJW0RpDAOY5ONIC1A1chSzeXD58PbOkhhitjzn6pv9ObNKOQjqKqrFN0b7KukX16OY7Gqk5Wiko+gY4lRrdjF7912v6EZrKrO9sXvc0QrH0GZQkEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgI4CeoEOJKLw3PsHsyE7wElZcPehvTy9N+jmXxLPAR9HyQWiq9Wl7OsDMnD3wEPe1lyarMft0Z9nblAXMQYFwdpFVtg6StWL1TKkhYsUgYu8ZM3obSRa515pwV+UWt2T84vQ07cZKvIb9Kutk2WU3dPyn9iDb5ZiLvZt4wtZmXpxX3r4h885B3R9EwsaOoznoiKFdDSXKQPmlHUKe4ZYVnHVRnodM6yC915kMdQe2fPjGKj1906otp7ReRTBJkfi1aUJDgmv4hBQ1/pEeQ/r0OQaWlFZsoSB2sQ9D44I6f6BUkjzYtqNOcU1DP293S1CPoftH9IDxYhYJEn5T70151RgQerMIiZpGyDkEOQ40QgvIyFHiwum1BAXKQTUqniGVlKMxg1TU4N0FZGZp1sGrp+6xI0MTg3ATlNTc0pyDhVsRaf1OQ7biZ/wgbuzFkKiif2cUZBZ2uZFDQ2/coKJigbKZfj1EIc7uigRS9WQtbmCBz08Kp237CCcplfrobhcmO7Cl6u1iIjvOYnz6NQjlq74ZD13cVgiq9d+z5MH5dOaSgPOanX6OgBqLGzISdCdYUWVdTFyPoaR/innJBBWUxd/Yq6L3xM21jS1hBeeWgWpBtzdQzuP43livo9TaXcZp5+4aFhQh6zUGBgmu9BFdTs57Ajz8W60yAUVDPS5MEJZ9+Nad92u+a+fhpe6BDC2p3rCdEawJjTvt4bb1UY9uCjpnMns/6BQkHEdbjxBP47aHGTj+FYGAcVq8XeuegdQgqLh8er69eiqFps6e98rdNQWpnQiXH8mCoUcgR27yCEi8BdQQV6h7XoBUrxc5XkHATYT1OOoHfKmJXqgA97dHM9OP1u20Kkm2UeuQSnrl/PtivyOwdaoyR0jlOOYE/Q096uqCUE/jxN3GuRpDD5ZajNnGGEJRwAr9VScNB2LgteGsR5HC/knGbOEdL6Rwnm8Dv9IMAI3NQEEHJpoaOp3Vp4EddcbgWQXqcgRiziTOQoAyKWJwJM/956EwFxQounKA0hkae1fmKQ599iSgHJTHUOql+bmkxbYfQmgVVZ7elGs2HXTgMKSiJoVYzv9O9m8BLz+sRpDqKStDgjKL/YDWooBSG3uSgYmDW3n+w6rezFQpKYOi0DioHuosjhhprEmS6ikO7qEYMVkMLmt+QzwkzyEF5CxpxxWFIQWk2MpyMxcD+Vt/Bqm55Qglq/U4gqDCZo5y41361gqqmch5YFPQIrv1XaEEzT7+aU7VmywbX5h2D6/wVXNC806/HDVTNCyGHGpEEzTrz0QgKdANACnIKrvNXBEEpilgMQXXXLoag+QwtVNB8PepGENx96BNc5zhODpqtVx1x0j6moHa3KGwKhlI0IZS+f2dcQa896yApsCctRnCdEhBLUPPCIgW1UxRNUPMzbAr6UxQ4uPY/OKYgQUHgeIaR/bIFzTCyX7qg6CP7hQuKP+qIJkiAhC1l4LoCQXHzkF/gjkvPM+egqIY8l33clp7bQ6U5ilhMQ1EWDucWFFORT8DOS8/zCoo79bGCHHQUFaVFi7L0nETQffoc5Lz03L6Gbj5BcVr8SP2gNIJi1EcrE6Qd1cchU+SKc0cxnaD7xlEKQe4dxaSC7kNW2HGa+SRSTo/DSIrTUcxCkInJVEuxOooZCLIRT5DzBXXWuGVEFEG4o7g+ZtxIskwoCDBS0LSNeksiSg5KW/3aGZWW0HIcAh1+O9W7Ib80MdAVC3J83vxmBbk+b36rgpyfFr5VQc57YbcqiDkIgVc1nAJdryDXwep2BW0QCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBAgvqBq8jZWZD7DcH+TxqzscQh96rnw37ruA4ILUfWQqexwfvxySp+cpQQg9PB/kx0ul3f+7iNCCzKyj/RYyA3O1lVktQSH0YO7pU57fjfguIrSgY1wt75d2dWKn7aEQrMicM/q7doIL0kXInk+Kb4T9MYpGEAjBSnF+N/q7dkILMhWAtRowT0+y3VFXpwyEYD+z9D72uwPMLKj+kOVfPEVQ1dTRmQtyyuS2G6VNKGJmnWUBRcypmrS19eMr6bL9aLisK2nQ0JoUDBaxMU11s2C3gGYeddV05Acr6RGdvcfrJsD8O4rqvznY2S+EsN5wuM5ZIITeUyrUl7y/i+BgFUBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCLERQvUE4AcsQVG8QTsEiBFUTH+o1hZwFqZ1i6vGUzQbhJOQsqHnC+0vgbYde5CxIavn7/W19REF9FM1lLxTUT3W8mwoF9fF8+KEWQ0G9lJf/1bcsoqA+1B2vajMU1Echm/j6OeYUlC0UBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBDgf2UAIAj6spJfAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>3.11:分别设置p1为0.25,0.4,0.5,0.75生成混合分布的随机数，可以看出p1为0.4和0.5时，分布为双峰分布。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> p1){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>r1<span class="ot">&lt;-</span><span class="fu">rnorm</span>(m)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>r2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(m,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>o<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),m,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>j,j))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span>o<span class="sc">*</span>r1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>o)<span class="sc">*</span>r2</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(z,<span class="at">prob=</span><span class="cn">TRUE</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;p1&quot;</span>,j))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">8</span>,<span class="fl">0.1</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y0,(j<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>y0<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>j)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>(y0<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>j))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAilBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6Ojo6OmY6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkLZmtttmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb////tmb/25D/27b//7b//9v///9e4rh6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIa0lEQVR4nO2daZvaNhhFxTQMXWLatEPTcdt0cRJMB///v1evYIOlK+FXSNj3fEhgsLbzSLJky7IqiBEVOgOxQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQFiFJSq9f705fi7Uqufu++5alm9FkXWfHz2mpn4BFVGzoKOu4GEgaB0kYK+/qT6gjK1+q34rNRL/5istvK2VYn//MQgKFVPf3xQ6t2noi77anMWVFag5+7fE4fmgPK/l5HYhIlDUL9feffn7iyorSWDXqn8Vh1ZNbfvlPr+k9/MRSLo6VPxpW43n9/vjz1BZS1J6iOe/jkdXv7tuQ3WafVIJIJeirMFJKitQMePm7JRft0MKpc8cQiqi5+1lQEIKltdv0PKPFehiATl7bkKCMqHp7R8OYLGatBIJz1obksRpO2Dms/90/yphR0+bJLiypc4kQg6ncWKoaCqWv3SDBTbP7eNrj6sHEN+2SxgJN2Ng9qqMBB0nmqcBbVdUPlJDUbdXohD0NPfH5X6oR3yDQSVU7NNM1lt/9zro/8rh9+r9379xCLIazcyCQoCUBCAggAxCIoaCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQFkBKkTItHFhHCJKOi+0UUABQEoCEBBAAoCUBCAggAUBKAggFuJUqWe6ye4dE/0L1xQtt6XjupdIRKB6B4ClxIdd0lR5PUztJnmOb9lC3rbli0rbx7h1jyfs2xBrEGIUx9Uq5oc3UPAsxiA4yAABQFuLFHGs5hbLLxoHya6CKAggFuJ2q1G9M+5L1xQ1m1cmOt2MJyxoIutwcbojZ8XOdWotkZNTMfWk9WGpU5WzY6WXoNqMlMXnHVzsCX2QRW5ajYL0+56VXZU5m2x5iyoKnxTcF0H4xTdXOidxST2I5yzoB8bPxOqT7EIQbp5umN0s6EtUXqejycC0c2IqxokFN1s4GweQEGApkRv26QbA07bsm+ugmKKLrIrt9EJUkLxSNGfaiTVVPWm3YflLtqri/+Dc85Iut4fNs9FOmn/6qnlUiOfwtKbi72Us/mXsFMNpfkckIGgtJQTdKqhtF+C0Wtiz2/b9f5tG7CJKcO3UAyuB61ej7tpW+hLCorDUEyn+cvAFIQCx2DonAd419QtOomwcQlKJfZNlxUUg6HeaT6xDXPYaN8MN6FEY0HjEgTfh3ea8OsborCgCAydcmBzgm/vF3qpQZqQwQ2dM5BbvFKxGkouVZDlBbN09epFkDZgaEPO6WcqoSAjh8039xQU2lAv+bKRrfdpAoOUI0pxQYZw0QjKV69ZNZtPZKKTCxfWUO80n9TLouyuBwkvJDcGi0RQNVCsBN10RXHiNWkQKqihqxqUTnpn4IwFtX1QNu0N3DeVBQWKRFAzVDSvovKzkBwGCmnIKW1PC8lnI8jTMmCLMAENXczFjD20p4XkjyEobTrnzLTALFwNCmioTTnvOmfDRNTTQnKrIKEF9a6WGe/N+1hIbhckmKEm4d4M7N63nm1DhDLUCYLdr0t0PkJQkHzUIoQWVAVQlwjFLUIUgv4dooskiKFOELzj5RKd4/EPIChYdE6CghgKK6g5/EqQtk8KYChKQfoadX9DDybo/oaCCmqPdhHULsS3GxhIIBP1jTm9RVA/YD8Dt2XcOo9BousOdhc0NeUbMhkiOlFBvipRQEGnY2UEeapE4QT1RjdCgrxUolkJ8qEomKD+6E9OkHw7CyVoMPhDgpwGPYFnl1LROQlyq1CyRQoi6LJKyAqSLZNbZEL35i+UuAqCTU6yq3aKSure/GWJHQVd/jy1WOa8OhwrdWf1sk1NFTRWo8QMuUQkdG9eSdegy+/OBTPn1h6ZGqTEm9ioIClDjn3Q9Hvz6l6CCpnrRG5RTL83P3aV3pMg9+LdVCLR6NToNVZpQaJXG+8i6Oo841fQlS/5EkHcFpKrOptiJXY8vJi0oYyXa9JXNSZC7itoxlAQQHiyOj+EJ6vzQ3iq0UYaNf4EWS+zmnjNb+I1VdlLsn5q0LREH1aQxWTVLtLZCsKTVbtI5ytIKFIKmvY7BVHQtN8paPGC5gQFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoC+BJk2gqtvv2YaH7MjbtgGYNaJH3YKPi+3SGeBOWGy9bHXWkg0+Sz2oYm1xoyBrVIOi9/cnzvgx9B9aaeuh+bHXjGF9A0d5a0O9CYglok3cTutn2LH0HZ+le02+B4NbEwoAtqkfThW/e38HkRVGYEbsc4voV+UwSwPYZp931j0vnTX1vXlzj6EFTVZCRIc+uxqRzGKmK8a2lOOquWpTi+W8WHIIsNPXNDHw0E6YJaJJ2tLOrnBR4E1c3ELEhbCXATM971Bkk3fZtxm7YrZAXVr2PP2mUmI9loX9eu32sPdtLGbfoKQ9IVjXi3rjrEQNGwXyw4zZuCWiTdrN8J3sRqDIIOm0QfzjxQNAa1SLrqonqLeGwIIKhtBxoLmWmqYQ6Kk64mMhGc5mcFBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgdkHNgpckXAZiF1Qx7cWdE3kAQW6LLqWJX9Bxh9akeyV+QZl5wZ1vohdktW7TI7ELCtzA4hcUuIFFL6jbGzXceSxyQeGhIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/wNtbnPkztC71QAAAABJRU5ErkJggg==" /><!-- --><br />
</p>
<p>3.20:分布取lamda为1,3,5进行模拟对比。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lamda<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> lamda){</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>t<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>r<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>beta<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>w1<span class="ot">&lt;-</span><span class="fu">rpois</span>(q,l<span class="sc">*</span>t)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>w2<span class="ot">&lt;-</span><span class="fu">rgamma</span>(q,r<span class="sc">*</span>w1,beta)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(w2,<span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;lamda&quot;</span>,l,<span class="st">&quot;compound possion distribution&quot;</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>wmean<span class="ot">&lt;-</span><span class="fu">mean</span>(w2)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>tmean<span class="ot">&lt;-</span>l<span class="sc">*</span>t<span class="sc">*</span>r<span class="sc">/</span>beta</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>wvar<span class="ot">&lt;-</span><span class="fu">var</span>(w2)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>tvar<span class="ot">&lt;-</span>l<span class="sc">*</span>t<span class="sc">*</span>r<span class="sc">*</span>(r<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>beta<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;lamda&quot;</span>,l,<span class="st">&quot;Distributed sample mean:&quot;</span>,wmean,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;lamda&quot;</span>,l,<span class="st">&quot;True sample mean:&quot;</span>,tmean,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;lamda&quot;</span>,l,<span class="st">&quot;Distributed sample mean:&quot;</span>,wvar,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;lamda&quot;</span>,l,<span class="st">&quot;True sample mean:&quot;</span>,tvar,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## lamda 1 Distributed sample mean: 4.022895 
## lamda 1 True sample mean: 4 
## lamda 1 Distributed sample mean: 2.408786 
## lamda 1 True sample mean: 2.4</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## lamda 3 Distributed sample mean: 12.05927 
## lamda 3 True sample mean: 12 
## lamda 3 Distributed sample mean: 7.078782 
## lamda 3 True sample mean: 7.2</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## lamda 5 Distributed sample mean: 19.7792 
## lamda 5 True sample mean: 20 
## lamda 5 Distributed sample mean: 11.43788 
## lamda 5 True sample mean: 12</code></pre>
<p>可以看出，样本分布和真实分布的均值和方差非常接近。<br />
Note that the <code>echo = FALSE</code> parameter was added to the code chunk to prevent printing of the R code that generated the plot.<br />
<br />
—————————2021-09-30———————————–<br />
<br />
##Question<br />
Exercises 5.4, 5.9, 5.13, and 5.14 (pages 149-151, Statistical Computating with R).</p>
<p><br />
##Answer<br />
5.4<br />
假设随机变量<span class="math inline">\(X\)</span>服从<span class="math inline">\(Beta(3,3)\)</span>,当<span class="math inline">\(x\)</span>属于<span class="math inline">\((0,1)\)</span>时，<span class="math inline">\(X\)</span>的密度函数为 <span class="math display">\[p(x)=30x^2(1-x)^2,0&lt;x&lt;1\]</span>分布函数可以表示为<span class="math display">\[F(x)=\int_{0}^{x}30(t^2-2t^3+t^4)dt\\=\int_{0}^{x}30x(t^2-2t^3+t^4)\frac{1}{x}dt\\=E(30x(T^2-2T^3+T^4))\]</span>其中，<span class="math inline">\(T\)</span>服从<span class="math inline">\(U(0,x)\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>beta33<span class="ot">&lt;-</span><span class="cf">function</span>(x,<span class="at">alpha=</span><span class="dv">3</span>,<span class="at">beta=</span><span class="dv">3</span>){</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  t<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>x)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  x0<span class="ot">&lt;-</span><span class="dv">30</span><span class="sc">*</span>x<span class="sc">*</span>(t<span class="sc">^</span><span class="dv">2-2</span><span class="sc">*</span>t<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span>t<span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(x0))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>j<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> x1){</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  y[j]<span class="ot">=</span><span class="fu">beta33</span>(i)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>y0<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">9</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> x1){</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  y0[k]<span class="ot">&lt;-</span><span class="fu">pbeta</span>(i,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">=</span><span class="fu">cbind</span>(x1,y,y0)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">col.names =</span><span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;simulation&#39;</span>,<span class="st">&#39;true&#39;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">x</th>
<th align="center">simulation</th>
<th align="center">true</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.1</td>
<td align="center">0.0085474</td>
<td align="center">0.00856</td>
</tr>
<tr class="even">
<td align="center">0.2</td>
<td align="center">0.0585408</td>
<td align="center">0.05792</td>
</tr>
<tr class="odd">
<td align="center">0.3</td>
<td align="center">0.1650280</td>
<td align="center">0.16308</td>
</tr>
<tr class="even">
<td align="center">0.4</td>
<td align="center">0.3119241</td>
<td align="center">0.31744</td>
</tr>
<tr class="odd">
<td align="center">0.5</td>
<td align="center">0.4995373</td>
<td align="center">0.50000</td>
</tr>
<tr class="even">
<td align="center">0.6</td>
<td align="center">0.6805351</td>
<td align="center">0.68256</td>
</tr>
<tr class="odd">
<td align="center">0.7</td>
<td align="center">0.8427222</td>
<td align="center">0.83692</td>
</tr>
<tr class="even">
<td align="center">0.8</td>
<td align="center">0.9473116</td>
<td align="center">0.94208</td>
</tr>
<tr class="odd">
<td align="center">0.9</td>
<td align="center">0.9971875</td>
<td align="center">0.99144</td>
</tr>
</tbody>
</table>
<p>可以看出，模拟值和真实值十分接近，模拟效果很好。<br />
<br />
5.9<br />
Rayleigh密度函数为 <span class="math display">\[f(x)=\frac{x}{σ^2}e^{-x^2/(2σ^2)} , x≥0 , σ&gt;0\]</span>其分布函数为<span class="math display">\[F(x)=\int_{0}^{x}\frac{t}{σ^2}e^{-t^2/(2σ^2)}dt\\\int_{0}^{x}x\frac{t}{σ^2}e^{-t^2/(2σ^2)}\frac{1}{x}dt\\=E(x\frac{T}{σ^2}e^{-T^2/(2σ^2)})\]</span>其中，<span class="math inline">\(T\)</span>服从<span class="math inline">\(U(0,x)\)</span>,分别采用对偶变量<span class="math inline">\(T\)</span>,<span class="math inline">\(x-T\)</span>和相互独立变量<span class="math inline">\(T\)</span>,<span class="math inline">\(V\)</span>进行拟合，最后进行比较。</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>Rayleign<span class="ot">&lt;-</span><span class="cf">function</span>(x,sigma,<span class="at">N=</span><span class="dv">10000</span>,<span class="at">anti=</span><span class="cn">TRUE</span>){</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>x)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>anti) v <span class="ot">&lt;-</span> <span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>x) <span class="cf">else</span> v <span class="ot">&lt;-</span> x <span class="sc">-</span> u</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">c</span>(u,v)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>x<span class="sc">*</span>u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span>))<span class="sc">/</span>(sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(y))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1.5</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>y3<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>sd1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>sd2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>mean1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>mean2<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(x))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)){</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    y2[i]<span class="ot">&lt;-</span><span class="fu">Rayleign</span>(x[k],sigma,<span class="at">anti=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    y3[i]<span class="ot">&lt;-</span><span class="fu">Rayleign</span>(x[k],sigma,<span class="at">anti=</span><span class="cn">FALSE</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a> mean1[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(y2)</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a> mean2[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(y3)</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a> sd1[k]<span class="ot">&lt;-</span><span class="fu">sd</span>(y2)</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a> sd2[k]<span class="ot">&lt;-</span><span class="fu">sd</span>(y3) </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>percent<span class="ot">=</span>sd2<span class="sc">/</span>sd1</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>table2<span class="ot">&lt;-</span><span class="fu">cbind</span>(x,sigma,mean1,sd1,mean2,sd2,percent)</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">col.names =</span><span class="fu">c</span>(<span class="st">&#39;x&#39;</span>,<span class="st">&#39;sigma&#39;</span>,<span class="st">&quot;Mean value of simulated value of dual variable&quot;</span>,<span class="st">&quot;Standard deviation of simulated value of dual variable&quot;</span>,<span class="st">&quot;Mean of simulated values of independent variables&quot;</span>,<span class="st">&quot;Standard deviation of simulated value of independent variable&quot;</span>,<span class="st">&quot;Percentage reduction in standard deviation&quot;</span>))</span></code></pre></div>
<p>可以看出，x取不同的值，采用对偶变量模拟出结果的均值与采用独立变量模拟出结果的均值十分接近，但是采用对偶变量模拟出结果的方差总显著小于采用独立变量模拟出结果的方差，因此采用对偶变量进行模拟，效果更好。<br />
<br />
5.13&amp;5.14<br />
已知<span class="math inline">\(g(x)\)</span>函数形式为如下所示：<span class="math display">\[g(x)=\frac{x^2}{\sqrt(2\pi)}\exp(-\frac{x^2}{2})\]</span> 选出四个分布较为相似的函数，密度函数分别为<span class="math display">\[f_1(x)=\frac{x^\frac{1}{2}}{\sqrt(2\pi)}exp(-\frac{x}{2}))\]</span> <span class="math display">\[f_2(x)=\frac{11x}{10\sqrt(2\pi)}exp(-\frac{x^2}{2})\]</span><br />
<br />
—————————2021-10-14———————————–<br />
<br />
</p>
</div>
<div id="questions" class="section level2">
<h2>QUESTIONS:</h2>
<p><br />
1.Exercises 6.5 and 6.A (page 180-181, Statistical Computating with R).<br />
2.If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. We want to know if the powers are different at 0.05 level.<br />
(1)What is the corresponding hypothesis test problem?<br />
(2)What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test? Why?<br />
(3)Please provide the least necessary information for hypothesis testing.</p>
</div>
<div id="answers" class="section level2">
<h2>ANSWERS:</h2>
<p><br />
6.5:Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of<span class="math inline">\(\chi^2(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)<br />
分析：进行1000次试验，每次试验产生20个服从<span class="math inline">\(\chi^2(2)\)</span>的随机数，计算<span class="math inline">\(\bar\mu\)</span>和<span class="math inline">\(\hat\sigma\)</span>,真实均值的t-interval为<span class="math display">\[(\bar\mu-\frac{1}{\sqrt(n)}t_{0.975}(n-1)\hat\sigma,\bar\mu+\frac{1}{\sqrt(n)}t_{0.025}(n-1)\hat\sigma)\]</span>判断真实均值2是否在t-interval中，若在则用y表示为1否则为0，最后计算所有试验的y的均值则可得Coverage probability.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span>sigma<span class="ot">&lt;-</span>y<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>   u[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>   sigma[i]<span class="ot">&lt;-</span><span class="fu">sd</span>(x)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>   y[i]<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">&lt;=</span>u[i]<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.025</span>,n<span class="dv">-1</span>)<span class="sc">*</span>sigma[i]<span class="sc">/</span><span class="fu">sqrt</span>(n)<span class="sc">&amp;</span><span class="dv">2</span><span class="sc">&gt;=</span>u[i]<span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="sc">*</span>sigma[i]<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>cp1<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">mean</span>(y),<span class="dv">3</span>)</span></code></pre></div>
<p>得出Coverage Probability为0.908，小于0.95，该t-interval是liberal的。<br />
与Example 6.4进行对比：假设在Example 6.4中，<span class="math inline">\(X_1,X_2,…，X_n\)</span>也服从<span class="math inline">\(\chi^2(2)\)</span>，按原方式计算方差的置信区间，算出Coverage Probability,与t-interval的Coverage Probability进行比较，看谁更稳健。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>UCL<span class="ot">&lt;-</span>y<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">2</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  UCL[i]<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(x)<span class="sc">/</span><span class="fu">qchisq</span>(<span class="fl">0.05</span>,<span class="at">df=</span>n<span class="dv">-1</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  y[i]<span class="ot">&lt;-</span>(<span class="dv">4</span><span class="sc">&lt;=</span>UCL[i])</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>cp2<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">mean</span>(y),<span class="dv">3</span>)</span></code></pre></div>
<p>根据Example 6.4计算出来的Coverage Probability为0.781&lt;0.908,则可以判断：t区间比方差区间对偏离正态性更有稳健性。<br />
<br />
6.A:Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level<span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is <span class="math inline">\((i)\chi^2(1)\)</span>, <span class="math inline">\((ii) U(0,2)\)</span>, and <span class="math inline">\((iii) Exp(1)\)</span>. In each case, test <span class="math inline">\(H0:µ=µ_0\)</span> vs <span class="math inline">\(H0:µ\neqµ0\)</span>, where<span class="math inline">\(µ=µ_0\)</span>is the mean of <span class="math inline">\(\chi^2(1)\)</span>, <span class="math inline">\(U(0,2)\)</span>, and <span class="math inline">\(Exp(1)\)</span>, respectively.<br />
分析：分别在三种情形下，样本量分别取10,20,50,100,1000，在每种情形进行1000次试验，并且计算每次试验的p值：其中p值计算表达式为<span class="math display">\[p=P_{H_0}(|t|&gt;|t_0|)=2P_{H_0}(t&gt;|t_0|)=2(1-P_{H_0}(t\leq|t_0|))\]</span>t在<span class="math inline">\(H_0\)</span>成立时服从参数为n-1的t分布。最后计算1000次试验<span class="math inline">\(p&lt;0.05\)</span>的概率即为empirical Type I error rate。</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>p.val1<span class="ot">&lt;-</span>p.val2<span class="ot">&lt;-</span>p.val3<span class="ot">&lt;-</span>y<span class="ot">&lt;-</span>t<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>tie1<span class="ot">&lt;-</span>tie2<span class="ot">&lt;-</span>tie3<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(n))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n[k],<span class="at">df=</span>lambda)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>   t[i]<span class="ot">&lt;-</span><span class="fu">sqrt</span>(n[k])<span class="sc">*</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>   p.val1[i]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t[i]),n[k]<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  tie1[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(p.val1<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">&lt;-</span><span class="fu">runif</span>(n[k],<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>   t[i]<span class="ot">&lt;-</span><span class="fu">sqrt</span>(n[k])<span class="sc">*</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>   p.val2[i]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t[i]),n[k]<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  tie2[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(p.val2<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>   x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n[k],lambda)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>   t[i]<span class="ot">&lt;-</span><span class="fu">sqrt</span>(n[k])<span class="sc">*</span>(<span class="fu">mean</span>(x)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sd</span>(x)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>   p.val3[i]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pt</span>(<span class="fu">abs</span>(t[i]),n[k]<span class="sc">-</span><span class="dv">1</span>))</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  tie3[k]<span class="ot">&lt;-</span><span class="fu">mean</span>(p.val3<span class="sc">&lt;</span><span class="fl">0.05</span>)</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(n,tie1,tie2,tie3)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&#39;sample size&#39;</span>,<span class="st">&#39;chi_q&#39;</span>,<span class="st">&#39;uniform&#39;</span>,<span class="st">&#39;exp&#39;</span>),<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">sample size</th>
<th align="center">chi_q</th>
<th align="center">uniform</th>
<th align="center">exp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">10</td>
<td align="center">0.162</td>
<td align="center">0.060</td>
<td align="center">0.088</td>
</tr>
<tr class="even">
<td align="center">20</td>
<td align="center">0.111</td>
<td align="center">0.055</td>
<td align="center">0.091</td>
</tr>
<tr class="odd">
<td align="center">50</td>
<td align="center">0.080</td>
<td align="center">0.037</td>
<td align="center">0.063</td>
</tr>
<tr class="even">
<td align="center">100</td>
<td align="center">0.048</td>
<td align="center">0.054</td>
<td align="center">0.060</td>
</tr>
<tr class="odd">
<td align="center">1000</td>
<td align="center">0.047</td>
<td align="center">0.050</td>
<td align="center">0.054</td>
</tr>
</tbody>
</table>
<p>可以得出，三种分布下的empirical Type I error rate结果如上，在样本量较小时候，三个分布的empirical Type I error rate都与0.05有一定的差距，<span class="math inline">\(\chi^2(1)\)</span>下差距最大，<span class="math inline">\(U(0,2)\)</span>下比较接近，<span class="math inline">\(Exp(1)\)</span>下较为接近；而随着样本量的增大，三个分布的empirical Type I error rate都越来越趋近于0.05。<br />
<br />
补充题:<br />
(2)采用paired-test检验，因为是在特定环境下采用两种方法进行检验，两种方法检验得出结论有很强的的相关性，所以需要通过配对来消除这些混杂因素。<br />
(1)相应的假设检验为：<span class="math display">\[H_0:\bar{power_1}-\bar{power_2}=0\quad vs\quad H_1:\bar{power_1}-\bar{power_2}\neq0\]</span>其中，<span class="math inline">\(\bar{power_1}=\frac{1}{n}\sum_{i=1}^{n}power1_i\)</span>,<span class="math inline">\(\bar{power_2}=\frac{1}{n}\sum_{i=1}^{n}power2_i\)</span>,<span class="math inline">\(power1_i,power2_i\)</span>分别是两种方法在第i次试验所得power的结果，n为实验次数。<br />
令<span class="math inline">\(d_i=power1_i-power2_i\)</span>,<span class="math inline">\(\bar{d}=\frac{1}{n}\sum_{i=1}^{n}d_i=\bar{power_1}-\bar{power_2}\)</span>,则原假设和备择假设转化为：<span class="math display">\[H_0:\bar{d}=0\quad vs\quad H_1:\bar{d}\neq0\]</span>检验统计量为<span class="math display">\[t=\frac{\sqrt(n)(\bar{d}-0)}{sd(d)}\]</span>其中<span class="math inline">\(sd(d)=\sqrt(\frac{1}{n-1}\sum_{i=1}^{n}(d_i-\bar{d})^2)\)</span>。<br />
(3)因此，为了进行假设检验，我们需要知道每次试验两种方法所得power的值，即<span class="math inline">\(power1_i,power2_i\)</span>.则我们可以计算<span class="math inline">\(d_i\)</span>，进一步计算<span class="math inline">\(\bar{d}\)</span>和<span class="math inline">\(sd(d)\)</span>。并且，我们还需要<span class="math inline">\(d_i\)</span>相互独立同分布，服从正态分布的信息。在这些前提下，检验统计量<span class="math inline">\(t=\frac{\sqrt(n)(\bar{d}-0)}{sd(d)}\)</span>在原假设成立时服从<span class="math inline">\(t(n-1)\)</span>分布。于是，我们进行进一步假设检验。<br />
<br />
—————————2021-10-21———————————–<br />
<br />
</p>
</div>
<div id="question" class="section level2">
<h2>QUESTION</h2>
<p>Exercises 6.C (pages 182, Statistical Computating with R).</p>
</div>
<div id="answer-1" class="section level2">
<h2>ANSWER</h2>
<p>(1)Repeat Example 6.8<br />
Example 6.8是在显著性水平<span class="math inline">\(\alpha=0.05\)</span>时，针对不同的样本数量<span class="math inline">\(n=10,20,30,50,100,500\)</span>,基于<span class="math inline">\(\sqrt{b_1}\)</span>的渐近分布计算正态性偏度检验的Type I error rate.<br />
则现在我们在显著性水平<span class="math inline">\(\alpha=0.05\)</span>时，针对不同的样本数量<span class="math inline">\(n=10,20,30,50,100,500\)</span>,基于<span class="math inline">\(\frac{nb_{1,d}}{6}\)</span>的渐近分布<span class="math inline">\(\chi^{2}(\frac{d(d+1)(d+2)}{6})\)</span>，计算Mardia多元正态性偏度检验的Type I error rate.<br />
分析：假设总体分布为<span class="math inline">\(N_4(\mu,\Sigma)\)</span>,其中 <span class="math display">\[\mu=\begin{pmatrix}
    0\\\\
    0\\\\
    0\\\\
    0\\\\
  \end{pmatrix}
\Sigma=\begin{pmatrix}
    1 &amp; 0 &amp; 0 &amp; 0\\\\
    0 &amp; 1 &amp; 0 &amp; 0\\\\
    0 &amp; 0 &amp; 1 &amp; 0\\\\
    0 &amp; 0 &amp; 0 &amp; 1\\\\
\end{pmatrix}\]</span> 针对不同的n，我们做m次试验，从该分布中取样，计算检验统计量<span class="math inline">\(b_{1,d}\)</span>,借此计算Type I error rate.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>sigma<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">500</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>T1ER<span class="ot">&lt;-</span><span class="cf">function</span>(data,alpha){</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  nr<span class="ot">&lt;-</span><span class="fu">nrow</span>(data)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  nc<span class="ot">&lt;-</span><span class="fu">ncol</span>(data)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  cdata<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>nr<span class="sc">*</span>nc),<span class="at">nrow=</span>nr,<span class="at">ncol=</span>nc)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nc){</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    cdata[,i]<span class="ot">&lt;-</span>data[,i]<span class="sc">-</span><span class="fu">rowMeans</span>(data)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  sigma0<span class="ot">&lt;-</span>cdata<span class="sc">%*%</span><span class="fu">t</span>(cdata)<span class="sc">/</span>nc</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">t</span>(cdata)<span class="sc">%*%</span><span class="fu">solve</span>(sigma0)<span class="sc">%*%</span>cdata</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  bstacs<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">rowSums</span>(a<span class="sc">^</span>{<span class="dv">3</span>}))<span class="sc">/</span>nc<span class="sc">/</span>nc</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">as.integer</span>((nc<span class="sc">*</span>bstacs<span class="sc">/</span><span class="dv">6</span>)<span class="sc">&gt;</span>(<span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha,nr<span class="sc">*</span>(nr<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(nr<span class="sc">+</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">6</span>)))</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>tier1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">6</span>)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n)){</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  yy<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(n[i],mu,sigma)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>    yy[j]<span class="ot">&lt;-</span><span class="fu">T1ER</span>(<span class="at">data=</span><span class="fu">t</span>(x),<span class="at">alpha=</span><span class="fl">0.05</span>)</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  tier1[i]<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">mean</span>(yy),<span class="dv">3</span>)</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>TypeI<span class="ot">&lt;-</span><span class="fu">as.vector</span>(tier1)</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;10&#39;</span>,<span class="st">&#39;20&#39;</span>,<span class="st">&#39;30&#39;</span>,<span class="st">&#39;50&#39;</span>,<span class="st">&#39;100&#39;</span>,<span class="st">&#39;500&#39;</span>)</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(n,TypeI)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">t</span>(table),<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<p>可以看出，Mardia多元正态性偏度检验不是很稳健，在n为10的小样本时，Type I error rate甚至趋于0。当样本量取到500时，Type I error rate才比较接近0.05。<br />
<br />
(2)Repeat Example 6.10<br />
Example 6.10是混合正态分布的偏度检验，此时混合正态分布其实是不服从正态分布的，也就是总体分布是正态分布的原假设不成立，在这样的条件下计算拒绝原假设的概率，即检验的power。其中，显著性水平<span class="math inline">\(\alpha=0.1\)</span><br />
<br />
则现在我们在显著性水平<span class="math inline">\(\alpha=0.1\)</span>时，从<span class="math inline">\((1-\epsilon)N_{4}(\mu,\Sigma_1)+\epsilon{N_4(\mu,\Sigma_2})\)</span>中抽取样本，其中<span class="math display">\[\mu=\begin{pmatrix}
    0\\\\
    0\\\\
    0\\\\
    0\\\\
  \end{pmatrix}
\Sigma_1=\begin{pmatrix}
    1 &amp; 0 &amp; 0 &amp; 0\\\\
    0 &amp; 1 &amp; 0 &amp; 0\\\\
    0 &amp; 0 &amp; 1 &amp; 0\\\\
    0 &amp; 0 &amp; 0 &amp; 1\\\\
\end{pmatrix}
\Sigma_2=\begin{pmatrix}
    100 &amp; 0 &amp; 0 &amp; 0\\\\
    0 &amp; 100 &amp; 0 &amp; 0\\\\
    0 &amp; 0 &amp; 100 &amp; 0\\\\
    0 &amp; 0 &amp; 0 &amp; 100\\\\
\end{pmatrix}\]</span> 当<span class="math inline">\(0&lt;\epsilon&lt;1\)</span>时，总体分布也不服从多元正态分布，在此条件下计算拒绝原假设的概率。</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>epsi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">0.15</span>,.<span class="dv">01</span>),<span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="dv">1</span>,.<span class="dv">05</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>sigma1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>sigma2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">100</span>),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="dv">4</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ou<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(epsi))</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>xm<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span><span class="sc">*</span>n),<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span>n)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>power<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>power_ep<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(epsi))</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(epsi)){</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  w<span class="ot">&lt;-</span>epsi[i]</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    sigma_d<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>),<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>w,w))</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>      sigma_dd<span class="ot">&lt;-</span>sigma_d[k]</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(sigma_dd<span class="sc">==</span><span class="dv">1</span>){sigma<span class="ot">&lt;-</span>sigma1}</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{sigma<span class="ot">&lt;-</span>sigma2}</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>      xm[,k]<span class="ot">&lt;-</span><span class="fu">mvrnorm</span>(<span class="dv">1</span>,mu,sigma)</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>    power[j]<span class="ot">&lt;-</span><span class="fu">T1ER</span>(<span class="at">data=</span>xm,alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  power_ep[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(power)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epsi, power_ep, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="at">xlab =</span> <span class="fu">bquote</span>(epsi), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),col</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="ot">=</span><span class="st">&#39;blue&#39;</span>,<span class="at">main=</span><span class="st">&#39;epsilon-power&#39;</span>)</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> .<span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(power_ep <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>power_ep) <span class="sc">/</span> m) </span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsi, power_ep<span class="sc">+</span>se, <span class="at">lty =</span> <span class="dv">4</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(epsi, power_ep<span class="sc">-</span>se, <span class="at">lty =</span> <span class="dv">4</span>,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><br />
可以看出，大致在<span class="math inline">\(\epsilon&lt;0.15\)</span>时，检验的power随着<span class="math inline">\(\epsilon\)</span>增加而增加；在<span class="math inline">\(0.15&lt;\epsilon&lt;0.4\)</span>时，power保持稳定，十分接近1；之后逐渐下降至接近0；当<span class="math inline">\(\epsilon=0\)</span>或<span class="math inline">\(\epsilon=1\)</span>时，总体服从多元正态分布，power比较接近0.<br />
<br />
—————————2021-10-28———————————–<br />
<br />
## Question</p>
<p>Exercises 7.7, 7.8, 7.9, and 7.B(Pages213,Statistical Computing with R)<br />
<br />
## Answer<br />
<br />
7.7<br />
Refer to Exercise 7.6. Efron and Tibshirani discuss the following example [84, Ch. 7]. The five-dimensional scores data have a 5 × 5 covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\lambda_2&gt;\lambda_3&gt;\lambda_4&gt;\lambda_5\)</span> . In principal components analysis,<span class="math display">\[\theta=\frac{\lambda_1}{\sum_{i=1}^{5}\lambda_i}\]</span>measures the proportion of variance explained by the first principal component. Let <span class="math inline">\(\hat\lambda_1&gt;\hat\lambda_2&gt;\hat\lambda_3&gt;\hat\lambda_4&gt;\hat\lambda_5\)</span>be the eigenvalues of<span class="math inline">\(\hat\Sigma\)</span>, where<span class="math inline">\(\hat\Sigma\)</span>is the MLE of <span class="math inline">\(\Sigma\)</span>.Compute the sample estimate<span class="math display">\[\hat\theta=\frac{\hat\lambda_1}{\sum_{i=1}^{5}\hat\lambda_i}\]</span>of <span class="math inline">\(\theta\)</span>. Use bootstrap to estimate the bias and standard error of<span class="math inline">\(\hat\theta\)</span>.<br />
分析：利用Bootstrap方法，设定B=2000次，每一次重抽样计算计算样本协方差矩阵，然后计算该矩阵的特征值，进而求取<span class="math inline">\(\hat\theta_{(b)}^{\ast},b=1,…,B\)</span>的值。最后利用如下公式估计<span class="math inline">\(\hat\theta\)</span>的偏差与标准差。<span class="math display">\[bias(\hat\theta)\approx{E(\hat\theta^{\ast}|data)-\hat\theta}=\bar{\theta^{\ast}}-\hat\theta\]</span> <span class="math display">\[sd(\hat\theta)\approx{\sqrt{\frac{1}{B-1}\sum_{b=1}^{B}(\hat\theta_{(b)}^{\ast}-\bar{\theta^{\ast}})^2}}\]</span>其中，<span class="math inline">\(\bar{\theta^{\ast}}=\frac{1}{B}\sum_{b=1}^{B}\hat\theta_{(b)}^{\ast}\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(scor, <span class="at">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>data.cov<span class="ot">&lt;-</span><span class="cf">function</span>(data){</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  Nrow<span class="ot">&lt;-</span><span class="fu">nrow</span>(data)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  Ncol<span class="ot">&lt;-</span><span class="fu">ncol</span>(data)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  meansdata<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">nrow=</span>Nrow,<span class="at">ncol=</span>Ncol)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Ncol){</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    meansdata[,n]<span class="ot">&lt;-</span>data[,n]<span class="sc">-</span><span class="fu">rowMeans</span>(data)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  datacov<span class="ot">&lt;-</span>meansdata<span class="sc">%*%</span><span class="fu">t</span>(meansdata)<span class="sc">/</span>Ncol</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(datacov)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>theta_star<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>data.Sigma0<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>scor.values0<span class="ot">&lt;-</span><span class="fu">eigen</span>(data.Sigma0)</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>theta_hat<span class="ot">&lt;-</span>scor.values0<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(scor.values0<span class="sc">$</span>values)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>  data.ind<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">88</span>,<span class="at">size=</span><span class="dv">88</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>  data.boot<span class="ot">&lt;-</span>scor[data.ind,]</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>  data.Sigma<span class="ot">&lt;-</span><span class="fu">data.cov</span>(<span class="fu">t</span>(data.boot))</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>  scor.values<span class="ot">&lt;-</span><span class="fu">eigen</span>(data.Sigma)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  theta_star[i]<span class="ot">&lt;-</span>scor.values<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(scor.values<span class="sc">$</span>values)</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>theta.bias<span class="ot">&lt;-</span><span class="fu">mean</span>(theta_star)<span class="sc">-</span>theta_hat</span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>theta.sd<span class="ot">&lt;-</span><span class="fu">sd</span>(theta_star)</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(theta.bias,theta.sd)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<p>利用Bootstrap法计算得出，<span class="math inline">\(\hat\theta\)</span>的 偏差的估计值为0.0001944，标准差估计值为0.0461154.<br />
<br />
7.8<br />
Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.<br />
分析：利用Jackknife方法，每次去掉一个样本数据计算样本协方差矩阵，然后计算该矩阵的特征值，进而求取<span class="math inline">\(\hat\theta_{(j)},j=1,…,n\)</span>的值。最后利用如下公式估计<span class="math display">\[bias(\hat\theta)\approx(n-1)(\bar{\hat\theta_{(.)}}-\hat\theta)\]</span><span class="math display">\[sd(\hat\theta)\approx\sqrt{\frac{n-1}{n}\sum_{i=1}^{n}(\hat\theta_{(i)-}\bar{\hat\theta_{(.)}})^2}\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">88</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>data.jack<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span>n<span class="dv">-1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>theta_jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">88</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>scor.Sigma_j<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="at">ncol=</span><span class="dv">5</span>,<span class="at">nrow=</span><span class="dv">5</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  scor.jack<span class="ot">&lt;-</span>scor[<span class="sc">-</span>j,]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  scor.Sigma_j<span class="ot">&lt;-</span><span class="fu">data.cov</span>(<span class="fu">t</span>(scor.jack))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  scor.values_j<span class="ot">&lt;-</span><span class="fu">eigen</span>(scor.Sigma_j)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  theta_jack[j]<span class="ot">&lt;-</span>scor.values_j<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(scor.values_j<span class="sc">$</span>values)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>bias_jack<span class="ot">&lt;-</span>(n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta_jack)<span class="sc">-</span>theta_hat)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>sd_jack<span class="ot">&lt;-</span><span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta_jack<span class="sc">-</span>theta_hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(bias_jack,sd_jack)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">align=</span><span class="st">&quot;c&quot;</span>)</span></code></pre></div>
<p>利用Jackknife法计算得出，<span class="math inline">\(\hat\theta\)</span>的偏差的估计值为0.0010691，标准差估计值为0.0.0495524.<br />
<br />
7.9<br />
Refer to Exercise 7.7. Compute 95% percentile and BCa confidence intervals for <span class="math inline">\(\hat\theta\)</span>.<br />
分析：利用boot包里面的boot.ci函数来计算四种置信区间。</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>boot.theta<span class="ot">&lt;-</span><span class="cf">function</span>(x,ind){</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  data.Sigma0<span class="ot">&lt;-</span><span class="fu">cov</span>(x[ind,])</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  patch.values0<span class="ot">&lt;-</span><span class="fu">eigen</span>(data.Sigma0)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  theta_hat<span class="ot">&lt;-</span>patch.values0<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(patch.values0<span class="sc">$</span>values)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>CI_normal<span class="ot">&lt;-</span>CI_basic<span class="ot">&lt;-</span>CI_percent<span class="ot">&lt;-</span>CI_Bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>。</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>scor_theta<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>scor,<span class="at">statistic=</span>boot.theta, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>CI<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(scor_theta,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CI)</span></code></pre></div>
<p>可以得出Normal法计算出置信区间为(0.5268,0.7110)；<br />
Basic法计算出置信区间为(0.5317,0.7172);<br />
Percentile计算出置信区间为(0.5210,0.7065);<br />
BCa计算出置信区间为(0.5186,0.7034)。<br />
<br />
7.B<br />
Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^2(5)\)</span> distributions(positive skewness).<br />
分析：分别从正态分布和卡方分布中产生随机数，计算偏度统计量，然后利用boot.ci函数计算出三种置信区间，各实验1000次最后计算置信区间覆盖率以及真值分别落在置信区间左侧和右侧的概率。其中，<span class="math inline">\(N(0,1)\)</span>的偏度为0，<span class="math inline">\(\chi^2(5)\)</span>的偏度为1.265.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>skewfunc<span class="ot">&lt;-</span><span class="cf">function</span>(x,ind){</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  skew_x<span class="ot">&lt;-</span><span class="fu">mean</span>((x[ind]<span class="sc">-</span><span class="fu">mean</span>(x[ind]))<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  skew_y<span class="ot">&lt;-</span><span class="fu">mean</span>((x[ind]<span class="sc">-</span><span class="fu">mean</span>(x[ind]))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  skew<span class="ot">&lt;-</span>skew_x<span class="sc">/</span>skew_y</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(skew)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>xnorm.ci.norm<span class="ot">&lt;-</span>xnorm.ci.basic<span class="ot">&lt;-</span>xnorm.ci.perc<span class="ot">&lt;-</span>xchi.ci.norm<span class="ot">&lt;-</span>xchi.ci.basic<span class="ot">&lt;-</span>xchi.ci.perc<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  xnorm<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  xchi<span class="ot">&lt;-</span><span class="fu">rchisq</span>(n,<span class="at">df=</span><span class="dv">5</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  xnorm.boot<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>xnorm,<span class="at">statistic=</span>skewfunc,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  xchi.boot<span class="ot">&lt;-</span><span class="fu">boot</span>(<span class="at">data=</span>xchi,<span class="at">statistic=</span>skewfunc,<span class="at">R=</span><span class="dv">2000</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  norm_CI<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(xnorm.boot,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  chi_CI<span class="ot">&lt;-</span><span class="fu">boot.ci</span>(xchi.boot,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  xnorm.ci.norm[i,]<span class="ot">&lt;-</span>norm_CI<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>  xnorm.ci.basic[i,]<span class="ot">&lt;-</span>norm_CI<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  xnorm.ci.perc[i,]<span class="ot">&lt;-</span>norm_CI<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  xchi.ci.norm[i,]<span class="ot">&lt;-</span>chi_CI<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  xchi.ci.basic[i,]<span class="ot">&lt;-</span>chi_CI<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  xchi.ci.perc[i,]<span class="ot">&lt;-</span>chi_CI<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>norm.sk<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>chi.sk<span class="ot">&lt;-</span><span class="fl">1.265</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>norm.left<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(xnorm.ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span>norm.sk),<span class="fu">mean</span>(xnorm.ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span>norm.sk),<span class="fu">mean</span>(xnorm.ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span>norm.sk))</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>norm.right<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(xnorm.ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span>norm.sk),<span class="fu">mean</span>(xnorm.ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span>norm.sk),<span class="fu">mean</span>(xnorm.ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span>norm.sk))</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>chi.left<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(xchi.ci.norm[,<span class="dv">1</span>]<span class="sc">&gt;=</span>chi.sk),<span class="fu">mean</span>(xchi.ci.basic[,<span class="dv">1</span>]<span class="sc">&gt;=</span>chi.sk),<span class="fu">mean</span>(xchi.ci.perc[,<span class="dv">1</span>]<span class="sc">&gt;=</span>chi.sk))</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>chi.right<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(xchi.ci.norm[,<span class="dv">2</span>]<span class="sc">&lt;=</span>chi.sk),<span class="fu">mean</span>(xchi.ci.basic[,<span class="dv">2</span>]<span class="sc">&lt;=</span>chi.sk),<span class="fu">mean</span>(xchi.ci.perc[,<span class="dv">2</span>]<span class="sc">&lt;=</span>chi.sk))</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>norm.cov<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(norm.left<span class="sc">+</span>norm.right)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>chi.cov<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">-</span>(chi.left<span class="sc">+</span>chi.right)</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>ci.method<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;ci.norm&#39;</span>,<span class="st">&#39;ci.basic&#39;</span>,<span class="st">&#39;ci.percentile&#39;</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(ci.method,norm.left,norm.right,chi.left,chi.right,norm.cov,chi.cov)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<p>从上表可以得出，当总体分布为<span class="math inline">\(N(0,1)\)</span>时，三种置信区间的覆盖率都比较接近0.95，其中ci.percentile效果最好；真值落在置信区间左右两侧的概率相当。而当总体分布为<span class="math inline">\(\chi^2(5)\)</span>时，三种置信区间的覆盖率显著小于0.95，效果不是很好；并且真值落在置信区间右侧的概率显著大于落在左侧的概率。<br />
<br />
—————————2021-11-04———————————–<br />
<br />
## QUESTION EXERCISE 1:Exercise 8.2 (page 242, Statistical Computating with R).<br />
EXERCISE 2:Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.<br />
(A)Unequal variances and equal expectations,<br />
(B)Unequal variances and unequal expectations,<br />
(C)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution(mixture of two normal distributions),<br />
(D)Unbalanced samples (say, 1 case versus 10 controls).<br />
Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-2" class="section level2">
<h2>ANSWER</h2>
<p><br />
EXERCISE 1<br />
进行两次实验，每次实验产生两组样本：<br />
实验一：第一组样本从<span class="math inline">\(U(0,10)\)</span>中抽取，第二组样本从<span class="math inline">\(N(0,1)\)</span>中抽取，样本的抽取是相互独立的。<br />
实验二：第一组样本从<span class="math inline">\(t(1)\)</span>中抽取，第二组样本从<span class="math inline">\(N(0,1)\)</span>中抽取，样本的抽取是相互独立的。</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">20</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">10</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">20</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>s3<span class="ot">&lt;-</span><span class="fu">rt</span>(<span class="dv">20</span>,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>spearman01<span class="ot">&lt;-</span><span class="fu">cor</span>(s1,s2,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>spearman02<span class="ot">&lt;-</span><span class="fu">cor</span>(s3,s2,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">c</span>(s1,s2)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>ss<span class="ot">&lt;-</span><span class="fu">c</span>(s2,s3)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>spearman1<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>spearman2<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  z1<span class="ot">&lt;-</span>s[u]</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  z2<span class="ot">&lt;-</span>s[<span class="sc">-</span>u]</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  spearman1[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(z1,z2,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>p_value_spearman1<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">abs</span>(spearman1)<span class="sc">&gt;</span><span class="fu">abs</span>(spearman01))</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>p_value_cor.test.spearman<span class="ot">&lt;-</span><span class="fu">cor.test</span>(s1,s2,<span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>p_value_cor.test.pearson<span class="ot">&lt;-</span><span class="fu">cor.test</span>(s1,s2,<span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>p_value_cor.test.kendall<span class="ot">&lt;-</span><span class="fu">cor.test</span>(s1,s2,<span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>p_value<span class="ot">&lt;-</span><span class="fu">cbind</span>(p_value_spearman1,p_value_cor.test.spearman,p_value_cor.test.pearson,p_value_cor.test.kendall)</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(p_value,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">caption=</span><span class="st">&#39;N(0,1) VS U(0,10)&#39;</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  z1<span class="ot">&lt;-</span>ss[u]</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  z2<span class="ot">&lt;-</span>ss[<span class="sc">-</span>u]</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  spearman2[i]<span class="ot">&lt;-</span><span class="fu">cor</span>(z1,z2,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>p_value_spearman2<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">abs</span>(spearman2)<span class="sc">&gt;</span><span class="fu">abs</span>(spearman02))</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>p_value_cor.test.spearman<span class="ot">&lt;-</span><span class="fu">cor.test</span>(s3,s2,<span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="at">method=</span><span class="st">&quot;spearman&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>p_value_cor.test.pearson<span class="ot">&lt;-</span><span class="fu">cor.test</span>(s3,s2,<span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="at">method=</span><span class="st">&quot;pearson&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>p_value_cor.test.kendall<span class="ot">&lt;-</span><span class="fu">cor.test</span>(s3,s2,<span class="at">alternative =</span> <span class="fu">c</span>(<span class="st">&quot;two.sided&quot;</span>),<span class="at">method=</span><span class="st">&quot;kendall&quot;</span>)<span class="sc">$</span>p.value</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>p_value<span class="ot">&lt;-</span><span class="fu">cbind</span>(p_value_spearman2,p_value_cor.test.spearman,p_value_cor.test.pearson,p_value_cor.test.kendall)</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(p_value,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">caption=</span><span class="st">&#39;N(0,1) VS t(1)&#39;</span>)</span></code></pre></div>
<p>在实验一中，四种检验的p值均小于0.05，都拒绝原假设。<br />
在实验二中，使用pearson的cor.test的p值小于0.05，应该拒绝原假设，认为两组样本不存在线性相关。但是使用spearman的cor.test、使用kendall的cor.test和the bivariate Spearman rank correlation test的p值都大于0.05，不能拒绝原假设，认为两组样本存在某种依赖关系。<br />
这可能是因为<span class="math inline">\(t(1)\)</span>与<span class="math inline">\(N(0,1)\)</span>分布比较相似。<br />
<br />
EXERCISE 2<br />
(A)Unequal variances and equal expectations<br />
样本一从<span class="math inline">\(N(0,1)\)</span>中抽取，样本二分别从<span class="math inline">\(N(0,2)\)</span>,<span class="math inline">\(N(0,10)\)</span>,<span class="math inline">\(N(0,100)\)</span>三种分布中抽取,对该三种组合都分别进行NN test、Energy test、Ball test。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RANN)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>NN3<span class="ot">&lt;-</span><span class="cf">function</span>(sample,ind,index1,index2,k0){</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span>index1<span class="sc">+</span>index2</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  sample<span class="ot">&lt;-</span><span class="fu">data.frame</span>(sample,<span class="dv">1</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span>sample[ind,]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  kNN<span class="ot">&lt;-</span><span class="fu">nn2</span>(<span class="at">data=</span>s,<span class="at">k=</span>k0<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  x1<span class="ot">&lt;-</span>kNN<span class="sc">$</span>nn.idx[<span class="dv">1</span><span class="sc">:</span>index1,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">&lt;-</span>kNN<span class="sc">$</span>nn.idx[(index1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  r1<span class="ot">&lt;-</span><span class="fu">sum</span>(x1<span class="sc">&lt;=</span>index1)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  r2<span class="ot">&lt;-</span><span class="fu">sum</span>(y1<span class="sc">&gt;</span>index1)</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  NNres<span class="ot">&lt;-</span>(r1<span class="sc">+</span>r2)<span class="sc">/</span>(k0<span class="sc">*</span>N)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(NNres)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>threetests<span class="ot">&lt;-</span><span class="cf">function</span>(oridata,xdata,ydata){</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  ind1<span class="ot">&lt;-</span><span class="fu">length</span>(xdata)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  ind2<span class="ot">&lt;-</span><span class="fu">length</span>(ydata)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  t0<span class="ot">&lt;-</span><span class="fu">NN3</span>(<span class="at">sample=</span>oridata,<span class="at">index1=</span>ind1,<span class="at">index2=</span>ind2,<span class="at">k0=</span><span class="dv">3</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  NN.boot<span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> oridata, <span class="at">statistic =</span> NN3, <span class="at">R =</span> <span class="dv">10000</span>,<span class="at">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="at">index1=</span>ind1,<span class="at">index2=</span>ind2,<span class="at">k0=</span><span class="dv">3</span>)</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  NN_pvalue<span class="ot">&lt;-</span><span class="fu">round</span>(<span class="fu">mean</span>(NN.boot<span class="sc">$</span>t<span class="sc">&gt;=</span>NN.boot<span class="sc">$</span>t0),<span class="dv">5</span>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(energy)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>  boot.obs <span class="ot">&lt;-</span> <span class="fu">eqdist.etest</span>(<span class="at">x=</span>oridata, <span class="at">sizes=</span><span class="fu">c</span>(ind1,ind2), <span class="at">R=</span><span class="dv">10000</span>)</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>  Energy_pvalue<span class="ot">&lt;-</span> <span class="fu">round</span>(boot.obs<span class="sc">$</span>p.value,<span class="dv">5</span>)</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Ball检验</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">library</span>(Ball)</span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  Ball_pvalue<span class="ot">=</span> <span class="fu">round</span>(<span class="fu">bd.test</span>(<span class="at">x =</span> xdata, <span class="at">y =</span> ydata, <span class="at">num.permutations=</span><span class="dv">10000</span>)<span class="sc">$</span>p.value,<span class="dv">5</span>)</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(NN_pvalue,Energy_pvalue,Ball_pvalue))</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>sd<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>p_value<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sd)){</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>))</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span>sd[i]))</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>  p_value[i,]<span class="ot">&lt;-</span><span class="fu">threetests</span>(<span class="at">oridata=</span>z,<span class="at">xdata=</span>x,<span class="at">ydata=</span>y)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_value)</span></code></pre></div>
<pre><code>##        [,1]    [,2]    [,3]
## [1,] 0.3097 0.32017 0.10329
## [2,] 0.0000 0.00020 0.00010
## [3,] 0.0000 0.00010 0.00010</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sd_value<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;sd=2&#39;</span>,<span class="st">&#39;sd=10&#39;</span>,<span class="st">&#39;sd=100&#39;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(sd_value,p_value)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&#39;sd_value&#39;</span>,<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;Energy test&#39;</span>,<span class="st">&#39;Ball test&#39;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">sd_value</th>
<th align="center">NN test</th>
<th align="center">Energy test</th>
<th align="center">Ball test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">sd=2</td>
<td align="center">0.3097</td>
<td align="center">0.32017</td>
<td align="center">0.10329</td>
</tr>
<tr class="even">
<td align="center">sd=10</td>
<td align="center">0</td>
<td align="center">2e-04</td>
<td align="center">1e-04</td>
</tr>
<tr class="odd">
<td align="center">sd=100</td>
<td align="center">0</td>
<td align="center">1e-04</td>
<td align="center">1e-04</td>
</tr>
</tbody>
</table>
<p>可以看出，当两组样本的分布相差不是很大时，例如样本分别服从<span class="math inline">\(N(0,2)\)</span>时，三种检验的p值都大于0.05，检验的效果不佳。此时，我们不能拒绝原假设，认为两组样本的分布相同。<br />
而当两组样本的分布相差较大时，例如第二组样本服从<span class="math inline">\(N(0,10)\)</span>和<span class="math inline">\(N(0,100)\)</span>时，NN检验的p值等于0，Energy检验和Ball检验的p值都趋于0，此时，我们可以拒绝原假设，认为两组样本的分布不相同。<br />
可以看出，在样本分布相差不大时，三种检验效果差不多；样本分布相差较大时，NN检验效果更好。<br />
<br />
(B)Unequal variances and unequal expectations<br />
样本一从<span class="math inline">\(N(0,1)\)</span>中抽取，样本二分别从<span class="math inline">\(N(1,2)\)</span>,<span class="math inline">\(N(2,5)\)</span>,<span class="math inline">\(N(10,100)\)</span>三种分布中抽取样本,对该种组合都进行NN test、Energy test、Ball test。</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mu<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>p_value2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sd)){</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="at">mean=</span>mu[i],<span class="at">sd=</span>sd[i]))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  z<span class="ot">&lt;-</span><span class="fu">c</span>(x,y)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  p_value2[i,]<span class="ot">&lt;-</span><span class="fu">threetests</span>(<span class="at">oridata=</span>z,<span class="at">xdata=</span>x,<span class="at">ydata=</span>y)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>sd_value<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;mu=1,sd=2&#39;</span>,<span class="st">&#39;mu=2,sd=5&#39;</span>,<span class="st">&#39;mu=10,sd=100&#39;</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(sd_value,p_value2)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">align=</span><span class="st">&#39;c&#39;</span>,<span class="at">col.names=</span><span class="fu">c</span>(<span class="st">&#39;sd_value&#39;</span>,<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;Energy test&#39;</span>,<span class="st">&#39;Ball test&#39;</span>))</span></code></pre></div>
<p>可以看出，当两组样本的分布相差不是很大时，例如样本分别服从<span class="math inline">\(N(0,1)\)</span>和<span class="math inline">\(N(1,2)\)</span>时，NN检验的p值大于0.05，检验的效果不佳。此时，我们不能拒绝原假设，认为两组样本的分布相同。而Energy检验和Ball检验的p值都小于0.05，此时，我们可以拒绝原假设，认为两组样本的分布不相同。<br />
而当两组样本的分布相差较大时，例如第二组样本服从<span class="math inline">\(N(2,5)\)</span>和<span class="math inline">\(N(10,100)\)</span>时，NN检验、Energy检验和Ball检验的p值都小于0.05，此时，我们可以拒绝原假设，认为两组样本的分布不相同。<br />
从上述结果可以看出，NN检验在样本分布相差不大时，检验效果不是很理想，但是在样本分布相差很大时，检验效果很好。Energy检验和Ball检验的效果差不多。<br />
<br />
(C)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution(mixture of two normal distributions)<br />
样本一从<span class="math inline">\(t(1)\)</span>中抽取，样本二分别从<span class="math inline">\(0.3*N(0,1)+0.7*N(1,10)\)</span>中抽取样本,对该种组合都进行NN test、Energy test、Ball test.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>x1<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rt</span>(<span class="dv">20</span>,<span class="at">df=</span><span class="dv">1</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">20</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>rind<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">replace=</span><span class="cn">TRUE</span>,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>){</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(rind[i]<span class="sc">==</span><span class="dv">1</span>) y1[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> y1[i]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">10</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>z1<span class="ot">&lt;-</span><span class="fu">c</span>(x1,y1)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>p_value3<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>p_value3<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">threetests</span>(<span class="at">oridata=</span>z1,<span class="at">xdata=</span>x1,<span class="at">ydata=</span>y1))</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>methods<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;Energy test&#39;</span>,<span class="st">&#39;Ball test&#39;</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>table3<span class="ot">&lt;-</span><span class="fu">rbind</span>(methods,p_value3)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table3,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<p>可以看出，Ball test的p值显著小于0.05,，此时应拒绝原假设，认为两组样本服从不同的分布。而NN test和Energy test的p值都大于0.05，此时不能拒绝原假设。此时Ball检验的效果最佳。<br />
<br />
(D)Unbalanced samples (say, 1 case versus 10 controls)<br />
两组样本都从<span class="math inline">\(t(1)\)</span>中抽取,但是第一组只抽取10个样本，第二组抽取1000个样本。</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>x2<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rt</span>(<span class="dv">10</span>,<span class="at">df=</span><span class="dv">1</span>))</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y2<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">rt</span>(<span class="dv">1000</span>,<span class="at">df=</span><span class="dv">1</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>z2<span class="ot">&lt;-</span><span class="fu">c</span>(x2,y2)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>p_value4<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>p_value4<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">threetests</span>(<span class="at">oridata=</span>z2,<span class="at">xdata=</span>x2,<span class="at">ydata=</span>y2))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>methods<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;NN test&#39;</span>,<span class="st">&#39;Energy test&#39;</span>,<span class="st">&#39;Ball test&#39;</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>table4<span class="ot">&lt;-</span><span class="fu">rbind</span>(methods,p_value4)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table4,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<p>可以看出，三种检验的p值均显著大于0.05,，此时不能拒绝原假设，不能认为两组样本服从不同的分布。其中，Energy test的表现最好。<br />
<br />
—————————2021-11-11———————————–<br />
<br />
## QUESTION</p>
<p>1.EXERCISES 9.3 and 9.8(Pages 277-278,Statistical Computating with R)<br />
2.For each of the above exercises, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.<br />
<br />
## ANSWER<br />
9.3：Use the Metropolis-Hastings sampler to generate random variables from a standard Cauchy distribution. Discard the first 1000 of the chain, and compare the deciles of the generated observations with the deciles of the standard Cauchy distribution (see qcauchyor qt with df=1). Recall that a Cauchy(θ,η) distribution has density function<span class="math display">\[f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0\]</span>The standard Cauchy has the Cauchy(θ = 1,η = 0) density. (Note that the standard Cauchy density is equal to the Student t density with one degree offreedom.)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>target_func<span class="ot">&lt;-</span><span class="cf">function</span>(x,theta,eta){</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  tar1<span class="ot">&lt;-</span>((x<span class="sc">-</span>eta)<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  tar2<span class="ot">&lt;-</span>theta<span class="sc">*</span>pi<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>tar1)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  tar3<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span>tar2</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tar3)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>experiments<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(experiments)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>reject_times<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>Cauchyfunc<span class="ot">&lt;-</span><span class="cf">function</span>(orix,times){</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>]<span class="ot">&lt;-</span>orix</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  N<span class="ot">&lt;-</span>times</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    y<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>x[i<span class="dv">-1</span>],<span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    MHSamde<span class="ot">&lt;-</span><span class="fu">target_func</span>(<span class="at">x=</span>y,<span class="at">theta=</span><span class="dv">1</span>,<span class="at">eta=</span><span class="dv">0</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>    MHSamda<span class="ot">&lt;-</span><span class="fu">target_func</span>(<span class="at">x=</span>x[i<span class="dv">-1</span>],<span class="at">theta=</span><span class="dv">1</span>,<span class="at">eta=</span><span class="dv">0</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(u<span class="sc">&lt;=</span>MHSamde<span class="sc">/</span>MHSamda){x[i]<span class="ot">&lt;-</span>y}</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{x[i]<span class="ot">&lt;-</span>x[i<span class="dv">-1</span>];reject_times<span class="ot">&lt;-</span>reject_times<span class="sc">+</span><span class="dv">1</span>}</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Rejection rate:&#39;</span>,reject_times<span class="sc">/</span>times))</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">Cauchyfunc</span>(x[<span class="dv">1</span>],experiments)</span></code></pre></div>
<pre><code>## [1] &quot;Rejection rate: 0.3576&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>strunc<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>x_strunc<span class="ot">&lt;-</span>x[strunc<span class="sc">+</span><span class="dv">1</span><span class="sc">:</span>experiments]</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>perc<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>mcmc_perc<span class="ot">&lt;-</span><span class="fu">quantile</span>(x_strunc,<span class="at">probs=</span>perc,<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>true_perc<span class="ot">&lt;-</span><span class="fu">qcauchy</span>(perc,<span class="at">scale=</span><span class="dv">1</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>compare_perc<span class="ot">&lt;-</span><span class="fu">cbind</span>(mcmc_perc,true_perc)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(compare_perc)</span></code></pre></div>
<pre><code>##      mcmc_perc  true_perc
## 10% -3.5895734 -3.0776835
## 20% -1.4887531 -1.3763819
## 30% -0.8611520 -0.7265425
## 40% -0.4428950 -0.3249197
## 50% -0.0850647  0.0000000
## 60%  0.2275325  0.3249197
## 70%  0.5759876  0.7265425
## 80%  1.0653813  1.3763819
## 90%  2.1449080  3.0776835</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(true_perc,mcmc_perc, <span class="at">main=</span><span class="st">&quot;deciles&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Cauchy Deciles&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Sample Deciles&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAolBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQttuQtv+Q27aQ2/+2ZgC2Zjq2kDq225C229u22/+2///bkDrbkGbbtmbb2//b////tmb/trb/25D/27b//7b//9v///92+egXAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJtUlEQVR4nO2dC3ubNhSGSdvZu3Tr4u5WZ1u30q0t68Ic2///r01H4uYE+BBISODvfZ4krRECv484EugAyZn0koTegdihIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABEJSpNnn9qXnO6SL+71r3n3SKAgwCIEaa5Z0On9Nnnx1gg6vU+Sm1fGxOevk+T5m8sW1Fj+j1p8891Hv/sWgyD11Q1K0HGn//VC2lJqPr1tCmosz6qVfBKDoDxJNvfSMtR3Vc3o4/mwVVbk4+/vH3bq04agerlStbk/fxaBPolBkDm2jqJC/ZLvmxWupJ1896HRghrLlaUXH/zvXASC1DffyN/UfGvDzbtGUK4FXS5XPP/Jc+COQJAcK/JXBOVJU8CmKFELaiw/P/xg/vWH172LQFDZVIoWtH/08flRC9rXaz78rvoxz51/BIIexaDN5cf5y7eXMWhzse7pV8/dWAyCTC+WFr3YzZuz6rpUs1AfvxItyf6iFyuX605OjrP1t6BywNMYB6kQU328aRkHyfL3SV3UH1EIOv21VSNmc0g9/KY6qmJ4rEfSP1+OpBvLZXHy8gpG0lFDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIBjQclisBd03N1K8vq0hLb4G2ThZoSgVHJIN+d001PaorpISRo/g1fQHHf7c56on0lJo7ELSsrf4wSlSk5GQS1rCOnmuJNE5FUfYlMEHXc6/3+Sn+gFTYhB0zZr3XsGY3wv5mbzbqvzxxhBR0nwT6fdnrZmQfnNu0yC9CRDKxZ0ulMDaTWMXnc3XzFuHCSC1j1QrBjfgtJJJ2MrFlTEoKx5R5/H7YZmZC82+e6rVQuadbuhoSAABQEsBRV3gmrYzY8rGKQ6f1yZIPvLCNclyOoCT72KRUF1ilqFoeXFoKTx224dlwXPg0L5dQtS52tdXoJeUZxLUKqfl9F7OQhesl5rDBLMaTyY1cjBueyKezG5HiTwelBHQbkeJPCKYldBcyXosF3ANWkHncGYIK0foLaE60EjYnJrHW4LBqmuZxsTt0RBgyqxK7iUicNQgpYzcRgmBsU/cVj3XUF6segnDl20m8va7ArGPnHoJPI8rs6qYOQTh+EFRT5xGIGgWbdrU2edExYyBs28XbsqjSGXl+PG9GJyQXBkhPZ4RdHxoXVZrUXB1ATnbOIT4lcrKC+D82EbWS8Wh6DGtebo7tVwG5ybtVoUbJyBxXeq4WWuxFpQdWBFc6rhdw5p+YL8HFkX1VsUjE+Qp9j8qP7BBSkIFIwvgSoyQfNvd1BN8cSg+bc7oKqYerH5t9tZwUwJIksV5PnAutyQ24LnORKofIfmx1tyWVDoTKAaV13X6rEKGjBx6DuBKmpBgyYOfSdQRRyDJk0curuiGG8vFv3EoVt8ThyWuWiTthsanxOH1ypo8MTh1QoaCgUBnAoK9biPpZyLzTbuaduwRcFQF8zmGzm3b9llQS/VUdCg4ksRpI+zia+9XWsMEsz0fDYtg2rFvdjpzgyhY81RdMyIk9XXpunwZLWjYNmCMragjoLmWli0Wa6OGXM9yMVYccWCpm1uOc9RLFjIQDEcIwSVxxh7sfaCp7uJg2i77YZm3EX7GbcbmnEX7WfcbmhGxKDDl9PuY7HbbmjGCNoySPcVnPqobcvthoZBGsAgDWCQBkw4WYVBOu+Zf12xoEGkSXJ7+Pa+O2BduSC5HJuaS9cd5yVrFoRPVnW7MaGq68LsmgWp5pFteu84NOl5p3/PV9mC5NvnkoLXc1Jfped1ZjKuWtD+fPjqk/7ppJg1e5LKeQ1XFGWgKFM/vYLcbTc0I2KQHD/p7YBpn6tNoEo30pPhk/mrFTQUCgJcpyD9gMm+s6yaqxSkx4fSe7t4NMUSentbQfqBFPIOSAePpgiWFGWDdRLnbXnRdXL6S7i0OhusBe3L8wcKaitoztN1+JmcH7RKQTry6BOtiZMba41BksEpr6EtAvXE7a6xF5MhkPJz2M6cBhyMYPlBiyGQIFxt55LQq7haYWq1FASqpSBQLQWBaikIVEtBoFoKAtVSEKiWglYGBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAngSlI15EVdr/mhPzlJHvunpLkna38AzZq/8CJKE0Nx2X467llldqaWjptby4kcVz5KWGfRRe+VFUCObZjh5210QJputNWeptfy5ysF4umzUXnmMQZa7kie3LZk3nd+2o3y9uKOlRCTI/llWbYL6bp3pE9SVhGG9V74E5R1xsnedp1/KNISO5tAjKG/f+oi98nmI2WaKuBOUt8XocXvlcRxk3WE4O8Q62s+ovXItKKvHIEMziqtVrIJ0e/miwp7jyDbP2UsLMjthnQ7askJPN9+5ga6njI3bKz+HmNzcan8jftu+9wwUO76rvmfA3V55ikGpOmysU/Zbv3DP6UG7oMxkkLWtNGaveLIKoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQHmFqRzdHtzmNqedp6a+fbWeXUp7+aVDq3MLMikNqV9SUytgrTSw7Yrb2w1gorspd48uG5B3dlhqxFUPkHuP8lbKZJRiifw7U3iijxw98etLNBZU5lpM4Ugk8NbZaSV5ff16vK5fgePM2GzCrpIUi6fK1cJMv+5Pe4kU/7mnWT/PH75q/yVYjpJqiq/r1aXz6uHirphVkHNJ73r97rKlykFlQv1X7VAPyK9eBlKKSh79ql62mNdfl+vrj6f9iDIJwQTJORyKJSCyuzKqkWpJpY1Wo6gBJk4pAo3y6uf6vOOWzjGEu4QUyHj2d+NFlS2lkqQagppIbRxiOXFQ9ouyoug8nMzklhmDKpahAoRugE0D7EnLej4+s/i9crNIF31ZK0tqKR3IGFFsG5eh4pcH2JlzKljiv51uvumHA00uvmqR38Sg5qNxl2/H2KgqO/oMo1H/VdsqaPCdEOqjTS7/TJklQNF+b++HSU1PV1ZvuzF5HPdlKyz/DuZ+1RDvyBHf12d35vqNpEkvzTHQaWg+oVeF6caUkzH4ZZxkGmWY2537CLmk1V5D1VwYhaUuXhn3lTiFTT5wbtuiFdQJFAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwP83E2A9l6e5uAAAAABJRU5ErkJggg==" /><!-- --><br />
可以看出，Metropolis-Hastings sampler模拟出的随机数和真实分布的随机数的十分位数十分接近，模型效果不错。从QQ plot图中也可以看出，十分接近。<br />
<br />
9.8:This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto{C_{n}^{x}y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,…,n,0\leq{y}\leq{1}}\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are <span class="math inline">\(Binomial(n,y)\)</span> and <span class="math inline">\(Beta(x+a,n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density f(x,y).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>GXori<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>GXfunc<span class="ot">&lt;-</span><span class="cf">function</span>(ori,N){</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>   GbN<span class="ot">&lt;-</span>N</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>   GX<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span>GbN,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>   GX[,<span class="dv">1</span>]<span class="ot">&lt;-</span>ori</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>GbN){</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>GX[,i<span class="dv">-1</span>][<span class="dv">1</span>]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  GX[,i][<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,<span class="at">shape1=</span>x<span class="sc">+</span>a,<span class="at">shape2=</span>n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>GX[,i][<span class="dv">2</span>]</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  GX[,i][<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>y)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(GX)</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>GX<span class="ot">&lt;-</span><span class="fu">GXfunc</span>(GXori,<span class="dv">5000</span>)</span></code></pre></div>
<p>GX矩阵即为所得的二元分布的随机值。可以在Rmd文件中查看。<br />
<br />
2.For each of the above exercises, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1543231221</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>GRstat<span class="ot">&lt;-</span><span class="cf">function</span>(Cauchydata){</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">ncol</span>(Cauchydata)<span class="co">#the length of every chain is n </span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  k<span class="ot">&lt;-</span><span class="fu">nrow</span>(Cauchydata)<span class="co">#k chains</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  chainaver<span class="ot">&lt;-</span><span class="fu">rowMeans</span>(Cauchydata)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  allaver<span class="ot">&lt;-</span><span class="fu">mean</span>(chainaver)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  betweenvar<span class="ot">&lt;-</span>n<span class="sc">*</span><span class="fu">sum</span>((chainaver<span class="sc">-</span>allaver)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(k<span class="dv">-1</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  s<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  ss<span class="ot">&lt;-</span><span class="fu">numeric</span>(k)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>      s[j]<span class="ot">&lt;-</span>(Cauchydata[i,j]<span class="sc">-</span>chainaver[i])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    ss[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(s)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  withinvar<span class="ot">&lt;-</span><span class="fu">mean</span>(ss)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  VAR<span class="ot">&lt;-</span>((n<span class="dv">-1</span>)<span class="sc">*</span>withinvar<span class="sc">+</span>betweenvar)<span class="sc">/</span>n</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  R_hat<span class="ot">&lt;-</span><span class="fu">sqrt</span>(VAR<span class="sc">/</span>withinvar)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(R_hat)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">1</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">2</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">3</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span><span class="dv">4</span>,<span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>experi<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>burn_in<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>Cdata<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span>experi,<span class="at">nrow=</span><span class="fu">length</span>(x))</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>  Cdata[i,]<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">Cauchyfunc</span>(x[i],experi))</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>Cdata1<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(Cdata, <span class="dv">1</span>, cumsum))</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Cdata))</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>       Cdata1[i,] <span class="ot">&lt;-</span> Cdata[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(Cdata))</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>Cdata<span class="ot">&lt;-</span>Cdata1[,(burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>experi]</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>Cauchy_R_hat<span class="ot">&lt;-</span><span class="fu">GRstat</span>(Cdata)</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Cauchy_R_hat)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>r_hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, experi)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>experi)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>  r_hat[j] <span class="ot">&lt;-</span> <span class="fu">GRstat</span>(Cdata1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_hat[(burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>experi], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span></code></pre></div>
<p><br />
得出Cauchy_R_hat为1.0035261370658，<span class="math inline">\(1&lt;\hat{R}&lt;1.2\)</span>,且曲线完全在y=1和y=1.2之间，收敛效果很好。<br />
<br />
分析：分开检验X和Y的随机数的收敛性</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>gx<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span><span class="dv">4</span>,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>gx[,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.3</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>gx[,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.2</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>gx[,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="fl">0.1</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>gx[,<span class="dv">4</span>]<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>GbN<span class="ot">&lt;-</span><span class="dv">10000</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>burn_in<span class="ot">&lt;-</span><span class="dv">2000</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>GXdata1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span>GbN,<span class="at">nrow=</span><span class="dv">4</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>GXdata2<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span>GbN,<span class="at">nrow=</span><span class="dv">4</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  GXdata1[i,]<span class="ot">&lt;-</span><span class="fu">GXfunc</span>(gx[,i],GbN)[<span class="dv">1</span>,]</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  GXdata2[i,]<span class="ot">&lt;-</span><span class="fu">GXfunc</span>(gx[,i],GbN)[<span class="dv">2</span>,]</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>GXdata1<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(GXdata1, <span class="dv">1</span>, cumsum))</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(GXdata1))</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>       GXdata1[i,] <span class="ot">&lt;-</span> GXdata1[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(GXdata1))</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>GXdata2<span class="ot">&lt;-</span><span class="fu">t</span>(<span class="fu">apply</span>(GXdata2, <span class="dv">1</span>, cumsum))</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>   <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(GXdata2))</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>       GXdata2[i,] <span class="ot">&lt;-</span> GXdata2[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(GXdata2))</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>GXdata11<span class="ot">&lt;-</span>GXdata1[,(burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>GbN]</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>GXdata22<span class="ot">&lt;-</span>GXdata2[,(burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>GbN]</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>GXVAR_x<span class="ot">&lt;-</span><span class="fu">GRstat</span>(GXdata11)</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>GXVAR_y<span class="ot">&lt;-</span><span class="fu">GRstat</span>(GXdata22)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;x:&#39;</span>,GXVAR_x))</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;y:&#39;</span>,GXVAR_y))</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>GX_r_hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, GbN)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>GbN)</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>  GX_r_hat[j] <span class="ot">&lt;-</span> <span class="fu">GRstat</span>(GXdata1[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(GX_r_hat[(burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>GbN], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>GbN)</span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>  GX_r_hat[j] <span class="ot">&lt;-</span> <span class="fu">GRstat</span>(GXdata2[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(GX_r_hat[(burn_in<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>GbN], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><br />
得出x的<span class="math inline">\(\hat{R}\)</span>为3.03175,收敛效果一般;y的<span class="math inline">\(\hat{R}\)</span>为1.09467,收敛效果很好。从曲线来看，x的<span class="math inline">\(\hat{R}\)</span>曲线一直在y=1.2之上，收敛效果一般；y的<span class="math inline">\(\hat{R}\)</span>曲线在y=1.2之下，收敛效果不错。<br />
<br />
—————————2021-11-18———————————–<br />
<br />
## QUESTION<br />
(1)Exercises 11.3 and 11.5 (pages 353-354, Statistical Computing with R)<br />
(2)Suppose<span class="math inline">\(T_1,T_2,…,T_n\)</span>are i.i.d. samples drawn from the exponential distribution with expectation <span class="math inline">\(\lambda\)</span>. Those values greater than <span class="math inline">\(\tau\)</span> are not observed due to right censorship, so that the observed values are<span class="math inline">\(Y_i=T_i*I(T_i\leq\tau)+\tau*I((T_i&gt;\tau),i=1,2,…,n\)</span>.Suppose <span class="math inline">\(\tau=1\)</span> and the observed <span class="math inline">\(Y_i\)</span> values are as follows: <span class="math display">\[0.54,0.48,0.33,0.43,1.00,1.00,0.91,1.00,0.21,0.85\]</span>Use the E-M algorithm to estimate λ , compare your result with the observed data MLE (note: <span class="math inline">\(Y_i\)</span> follows a mixture distribution).</p>
</div>
<div id="answer-3" class="section level2">
<h2>ANSWER</h2>
<p><br />
(1)Exercises 11.3:<br />
(a) Write a function to compute the <span class="math inline">\(k^{th}\)</span> term in <span class="math display">\[\sum_{k=0}^{\infty}{\frac{(-1)^k}{k!2^k}\frac{{\Vert{a}\Vert}^{2k+2}}{(2k+1)(2k+2)}{\frac{\Gamma(\frac{d+1}{2})\Gamma(k+\frac{3}{2})}{\Gamma(k+\frac{d}{2}+1)}}}\]</span> where <span class="math inline">\(d&gt;1\)</span> is an integer, a is a vector in <span class="math inline">\(R^d\)</span>, and <span class="math inline">\(\Vert·\Vert\)</span> denotes the Euclidean norm. Perform the arithmetic so that the coefficients can be computed for (almost) arbitrarily large k and d. (This sum converges for all <span class="math inline">\(a\in{R^d}\)</span>).<br />
(b) Modify the function so that it computes and returns the sum.<br />
(c) Evaluate the sum when <span class="math inline">\(a=(1,2)^{T}\)</span> .</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">####(a)</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>JUAN<span class="ot">&lt;-</span><span class="cf">function</span>(k,a,d){</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>juan_k<span class="ot">&lt;-</span><span class="cf">function</span>(k,a,d){</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((k<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">|</span>(<span class="sc">!</span>k<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>)<span class="sc">|</span>(<span class="sc">!</span>d<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>)<span class="sc">|</span>(d<span class="sc">&lt;</span><span class="dv">1</span>)<span class="sc">|</span>(<span class="fu">length</span>(a)<span class="sc">!=</span>d)<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.vector</span>(a)))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    {<span class="fu">print</span>(<span class="st">&quot;print invalid value&quot;</span>)}</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>      a_length<span class="ot">&lt;-</span><span class="fu">sqrt</span>(a<span class="sc">%*%</span>a)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>      a1<span class="ot">&lt;-</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(a_length)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>      a2<span class="ot">&lt;-</span><span class="fu">lgamma</span>((d<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>      a3<span class="ot">&lt;-</span><span class="fu">lgamma</span>(k<span class="sc">+</span><span class="dv">3</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>      b1<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="fu">factorial</span>(k))</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>      b2<span class="ot">&lt;-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>)</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>      b3<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>      b4<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>      b5<span class="ot">&lt;-</span><span class="fu">lgamma</span>(k<span class="sc">+</span>d<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>      res<span class="ot">&lt;-</span>a1<span class="sc">+</span>a2<span class="sc">+</span>a3<span class="sc">-</span>b1<span class="sc">-</span>b2<span class="sc">-</span>b3<span class="sc">-</span>b4<span class="sc">-</span>b5</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(k<span class="sc">%%</span><span class="dv">2</span><span class="sc">==</span><span class="dv">0</span>){<span class="fu">return</span>(<span class="fu">exp</span>(res))}</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span>{<span class="fu">return</span>(<span class="sc">-</span><span class="fu">exp</span>(res))}</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="do">####(b)</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>sum_juan_k<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">k=</span><span class="dv">0</span>,a,d){</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>((k<span class="sc">&lt;</span><span class="dv">0</span>)<span class="sc">|</span>(<span class="sc">!</span>k<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>)<span class="sc">|</span>(<span class="sc">!</span>d<span class="sc">%%</span><span class="dv">1</span><span class="sc">==</span><span class="dv">0</span>)<span class="sc">|</span>(d<span class="sc">&lt;</span><span class="dv">1</span>)<span class="sc">|</span>(<span class="fu">length</span>(a)<span class="sc">!=</span>d)<span class="sc">|</span>(<span class="sc">!</span><span class="fu">is.vector</span>(a)))</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  {<span class="fu">print</span>(<span class="st">&quot;print invalid value&quot;</span>)}</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    x_sum<span class="ot">&lt;-</span><span class="dv">0</span> </span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    resdu<span class="ot">&lt;-</span><span class="dv">100</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span>(<span class="fu">abs</span>(resdu)<span class="sc">&gt;</span><span class="fl">1e-200</span>){</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>      x<span class="ot">&lt;-</span><span class="fu">juan_k</span>(<span class="at">k=</span>k,<span class="at">a=</span>a,<span class="at">d=</span>d)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>      x_sum<span class="ot">&lt;-</span>x_sum<span class="sc">+</span>x</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>      resdu<span class="ot">&lt;-</span>x</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x_sum)</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a><span class="do">###(c)</span></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">as.vector</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">length</span>(a)</span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a>a_sum<span class="ot">&lt;-</span><span class="fu">sum_juan_k</span>(<span class="at">k=</span><span class="dv">0</span>,a,<span class="at">d=</span><span class="dv">2</span>)</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(a_sum)</span></code></pre></div>
<pre><code>##          [,1]
## [1,] 1.532164</code></pre>
<p>最后计算出结果为1.53216399886164.<br />
<br />
(1)Exercise 11.5:<br />
Write a function to solve the equation:<span class="math display">\[\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_{0}^{c_{k-1}}{(1+\frac{u^2}{k-1})^{-k/2}du}=\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi{k}}\Gamma(\frac{k}{2})}\int_{0}^{c_{k}}{(1+\frac{u^2}{k})^{-(k+1)/2}du}\]</span>for a, where<span class="math display">\[c_k=\sqrt{\frac{a^2{k}}{k+1-a^2}}\]</span>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>in_func1<span class="ot">&lt;-</span><span class="cf">function</span>(u,m){</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  (<span class="dv">1</span><span class="sc">+</span>u<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(m<span class="dv">-1</span>))<span class="sc">^</span>(<span class="sc">-</span>m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>happy_func<span class="ot">&lt;-</span><span class="cf">function</span>(k,a){</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  l1<span class="ot">&lt;-</span><span class="fu">log</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  l2<span class="ot">&lt;-</span><span class="fl">0.5</span><span class="sc">*</span><span class="fu">log</span>((pi<span class="sc">*</span>(k<span class="dv">-1</span>)))<span class="sc">+</span><span class="fu">lgamma</span>((k<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  c_k_1<span class="ot">&lt;-</span><span class="fu">sqrt</span>((a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(k<span class="dv">-1</span>))<span class="sc">/</span>(k<span class="sc">-</span>a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  l3<span class="ot">&lt;-</span><span class="fu">integrate</span>(in_func1,<span class="at">rel.tol=</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.25</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>,<span class="at">lower=</span><span class="dv">0</span>,<span class="at">upper=</span>c_k_1,<span class="at">m=</span>k)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>  l3<span class="ot">&lt;-</span><span class="fu">log</span>(l3<span class="sc">$</span>value)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  y1<span class="ot">&lt;-</span><span class="fu">exp</span>(l1<span class="sc">+</span>l3<span class="sc">-</span>l2)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(y1)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>solu_func<span class="ot">&lt;-</span><span class="cf">function</span>(k){</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  output<span class="ot">&lt;-</span><span class="fu">uniroot</span>(<span class="cf">function</span>(a){<span class="fu">happy_func</span>(k,a)<span class="sc">-</span><span class="fu">happy_func</span>(k<span class="sc">+</span><span class="dv">1</span>,a)},<span class="at">lower=</span><span class="dv">1</span>,<span class="at">upper=</span><span class="dv">2</span>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>k_value<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>roots<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fu">length</span>(k_value))</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_value)){</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  roots[j]<span class="ot">&lt;-</span><span class="fu">solu_func</span>(k_value[j])<span class="sc">$</span>root</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>table<span class="ot">&lt;-</span><span class="fu">cbind</span>(k_value,roots)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">k_value</th>
<th align="center">roots</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">1.492103</td>
</tr>
<tr class="even">
<td align="center">5</td>
<td align="center">1.533556</td>
</tr>
<tr class="odd">
<td align="center">6</td>
<td align="center">1.562744</td>
</tr>
<tr class="even">
<td align="center">7</td>
<td align="center">1.584430</td>
</tr>
<tr class="odd">
<td align="center">8</td>
<td align="center">1.601185</td>
</tr>
<tr class="even">
<td align="center">9</td>
<td align="center">1.614521</td>
</tr>
<tr class="odd">
<td align="center">10</td>
<td align="center">1.625390</td>
</tr>
<tr class="even">
<td align="center">11</td>
<td align="center">1.634419</td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">1.642038</td>
</tr>
<tr class="even">
<td align="center">13</td>
<td align="center">1.648554</td>
</tr>
<tr class="odd">
<td align="center">14</td>
<td align="center">1.654190</td>
</tr>
<tr class="even">
<td align="center">15</td>
<td align="center">1.659114</td>
</tr>
<tr class="odd">
<td align="center">16</td>
<td align="center">1.663452</td>
</tr>
<tr class="even">
<td align="center">17</td>
<td align="center">1.667304</td>
</tr>
<tr class="odd">
<td align="center">18</td>
<td align="center">1.670745</td>
</tr>
<tr class="even">
<td align="center">19</td>
<td align="center">1.673840</td>
</tr>
<tr class="odd">
<td align="center">20</td>
<td align="center">1.676637</td>
</tr>
<tr class="even">
<td align="center">21</td>
<td align="center">1.679178</td>
</tr>
<tr class="odd">
<td align="center">22</td>
<td align="center">1.681496</td>
</tr>
<tr class="even">
<td align="center">23</td>
<td align="center">1.683620</td>
</tr>
<tr class="odd">
<td align="center">24</td>
<td align="center">1.685572</td>
</tr>
<tr class="even">
<td align="center">25</td>
<td align="center">1.687373</td>
</tr>
<tr class="odd">
<td align="center">100</td>
<td align="center">1.720608</td>
</tr>
<tr class="even">
<td align="center">500</td>
<td align="center">1.729756</td>
</tr>
<tr class="odd">
<td align="center">1000</td>
<td align="center">1.730907</td>
</tr>
</tbody>
</table>
<p>可以看出，计算出来的值与Exercise 11.4的值一致。<br />
<br />
(2):<br />
假设为样本缺失数据为<span class="math inline">\(X=x_1,x_2,...,x_m\)</span>，即大于<span class="math inline">\(\tau\)</span>的观测数据，<span class="math inline">\(Y=y_1,...,y_n\)</span>为小于和等于<span class="math inline">\(\tau\)</span>的观测数据。其中，<span class="math inline">\(m=3,n=10,\tau=1\)</span>.则似然函数为： <span class="math display">\[L=(\frac{1}{\lambda})^ne^{-\frac{1}{\lambda}(\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j)},\lambda&gt;0,x_i,y_j&gt;0,i=1,..,m,j=1,...,n-m \]</span> 取对数得： <span class="math display">\[log(L)=l(\lambda|X,Y)=log((\frac{1}{\lambda})^ne^{-\frac{1}{\lambda}(\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j)})=-nlog\lambda-\frac{1}{\lambda}(\sum_{i=1}^mx_i+\sum_{j=1}^{n-m}y_j)\]</span> 对第(j-1)次迭代得到的<span class="math inline">\(\lambda^{j-1}\)</span> E步期望为： <span class="math display">\[
\begin{aligned}
Q(\lambda,\lambda^{(j-1)})&amp;=E_{X|\lambda^{(j-1)},Y}[l(\lambda|X,Y)]\\
&amp;=-nlog\lambda-\frac{1}{\lambda}(\sum_{i=1}^mE(X_i|\lambda^{(j-1)},Y)+\sum_{j=1}^{n-m}y_j)
\end{aligned}
\]</span> 其中 <span class="math display">\[E(X_i|\lambda^{(j-1)},Y)=\int_{\tau}^\infty x\frac{1}{\lambda^{(j-1)}}e^{-\frac{1}{\lambda^{(j-1)}}(x-\tau)}dx=(\tau+\lambda^{(j-1)})\]</span> 将题目已知数据代入可得： <span class="math display">\[Q(\lambda,\lambda^{(j-1)})=-10log\lambda-\frac{1}{\lambda}(3(1+\lambda^{(j-1)})+3.75)\]</span> M步求最大值：将<span class="math inline">\(Q(\lambda,\lambda^{(j-1)})\)</span>对<span class="math inline">\(\lambda\)</span>进行求导： <span class="math display">\[\lambda^{(j)}=argmaxQ(\lambda,\lambda^{(j-1)})=\frac{3(1+\lambda^{(j-1)})+3.75}{10}\]</span> 对上述两步循环迭代直至收敛。<br />
可以看出： <span class="math display">\[\vert{\lambda^{(j)}-\lambda^{(j-1)}}\vert=\vert\frac{27-28\lambda^{(j-1)}}{40}\vert\leq\vert\frac{7}{10}\lambda^{(j-1)}\vert\leq(\frac{7}{10})^{j}{\lambda^{(0)}}\]</span> 则当j趋于无穷时，<span class="math inline">\(\lambda^{(\infty)}\)</span>收敛，且满足: <span class="math display">\[\lambda^{(\infty))}=\frac{3(1+\lambda^{(\infty))})+3.75)}{10}\]</span> 可得：<span class="math inline">\(\lambda^{(j)}\rightarrow0.96\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>lambda2<span class="ot">&lt;-</span><span class="fl">0.8</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>res<span class="ot">&lt;-</span><span class="dv">1000</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(res<span class="sc">&gt;</span>.Machine<span class="sc">$</span>double.eps<span class="sc">^</span><span class="fl">0.5</span>){</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  lambda1<span class="ot">&lt;-</span>lambda2</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  lambda2<span class="ot">&lt;-</span>(<span class="dv">3</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>lambda1)<span class="sc">+</span><span class="fl">3.75</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  res<span class="ot">&lt;-</span>lambda2<span class="sc">-</span>lambda1</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lambda2)</span></code></pre></div>
<pre><code>## [1] 0.9642857</code></pre>
<p>可以得出，收值为0.9642857,与分析所得0.96十分接近。<br />
<br />
—————————2021-11-25———————————–<br />
<br />
## QUESTION<br />
(1)Exercises 1 and 5 (page 204, Advanced R)<br />
(2)Excecises 1 and 7 (page 214, Advanced R)</p>
</div>
<div id="answer-4" class="section level2">
<h2>ANSWER</h2>
<p>(1)Exercises 1:<br />
Why are the following two invocations of lapply() equivalent?<br />
trims&lt;-c(0, 0.1, 0.2, 0.5)<br />
x&lt;-rcauchy(100)<br />
lapply(trims, function(trim) mean(x, trim = trim))<br />
lapply(trims, mean, x = x)<br />
<br />
1)构造了一个函数，该函数将trims中的值作为参数代入，固定x，以输入参数为trim的值。lapply()就是将trims里的每一个值作为函数输入值计算一次；<br />
2)第二个lapply()函数直接利用了系统内的mean函数,并且固定x，则lapply自动将trims的每一个值识别为mean()函数中的trim参数的设定值。<br />
因此两种方法计算结果一致。<br />
<br />
(1)Exercises 5:<br />
For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.<br />
rsq &lt;- function(mod) summary(mod)$r.squared</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">###EXAMPLE 3</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>lares<span class="ot">&lt;-</span><span class="fu">lapply</span>(formulas,<span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula=</span>x,<span class="at">data=</span>mtcars))</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="do">##use function rsq and lapply to extract R^2</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>r_square1<span class="ot">&lt;-</span><span class="fu">lapply</span>(lares,rsq)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>Formulas<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&#39;mpg ~ disp&#39;</span>,<span class="st">&#39;mpg ~ I(1 / disp)&#39;</span>,<span class="st">&#39;mpg ~ disp + wt&#39;</span>,<span class="st">&#39;mpg ~ I(1 / disp) + wt&#39;</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">#present the result in a table</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>table1<span class="ot">&lt;-</span><span class="fu">cbind</span>(Formulas,r_square1)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">Formulas</th>
<th align="center">r_square1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">mpg ~ disp</td>
<td align="center">0.71834334048973</td>
</tr>
<tr class="even">
<td align="center">mpg ~ I(1 / disp)</td>
<td align="center">0.859686504658705</td>
</tr>
<tr class="odd">
<td align="center">mpg ~ disp + wt</td>
<td align="center">0.780930581659292</td>
</tr>
<tr class="even">
<td align="center">mpg ~ I(1 / disp) + wt</td>
<td align="center">0.883803822574464</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="do">###EXAMPLE 4</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="co">#use bootstrap to generate data</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co">#use lapply to extract R^2</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>whp<span class="ot">&lt;-</span><span class="fu">lapply</span>(bootstraps,<span class="cf">function</span>(x) <span class="fu">lm</span>(<span class="at">formula=</span>mpg <span class="sc">~</span> disp,<span class="at">data=</span>x))</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>r_square2<span class="ot">&lt;-</span><span class="fu">lapply</span>(whp,rsq)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="co">#present the result in a table</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>table2<span class="ot">&lt;-</span><span class="fu">cbind</span>(r_square2)</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table2,<span class="at">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">r_square2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.549199841086178</td>
</tr>
<tr class="even">
<td align="center">0.680465054103738</td>
</tr>
<tr class="odd">
<td align="center">0.694661230747723</td>
</tr>
<tr class="even">
<td align="center">0.79520215113681</td>
</tr>
<tr class="odd">
<td align="center">0.80623611063048</td>
</tr>
<tr class="even">
<td align="center">0.805708289698806</td>
</tr>
<tr class="odd">
<td align="center">0.806174767235794</td>
</tr>
<tr class="even">
<td align="center">0.694337822644918</td>
</tr>
<tr class="odd">
<td align="center">0.604170524386881</td>
</tr>
<tr class="even">
<td align="center">0.610218206501082</td>
</tr>
</tbody>
</table>
<p>(2)Excecises 1:<br />
Use vapply() to:<br />
a) Compute the standard deviation of every column in a numeric data frame.<br />
b) Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="do">###a)</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a numeric data frame</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>orinumbers<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fu">runif</span>(<span class="dv">6</span>,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span><span class="dv">10</span>),<span class="at">y=</span><span class="fu">rnorm</span>(<span class="dv">6</span>),<span class="at">z=</span><span class="fu">rcauchy</span>(<span class="dv">6</span>))</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(orinumbers,sd,<span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##         x         y         z 
## 3.1080905 0.7789181 1.5222968</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">###b)</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#generate a mixed data frame</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>oribnum<span class="ot">&lt;-</span><span class="fu">data.frame</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">name=</span><span class="fu">c</span>(<span class="st">&#39;Anna&#39;</span>,<span class="st">&#39;Cindy&#39;</span>,<span class="st">&#39;Mike&#39;</span>,<span class="st">&#39;Ross&#39;</span>,<span class="st">&#39;Joey&#39;</span>,<span class="st">&#39;Melody&#39;</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex=</span><span class="fu">c</span>(<span class="st">&#39;F&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;M&#39;</span>,<span class="st">&#39;M&#39;</span>,<span class="st">&#39;M&#39;</span>,<span class="st">&#39;F&#39;</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height=</span><span class="fu">c</span>(<span class="fl">165.0</span>,<span class="fl">170.5</span>,<span class="fl">188.3</span>,<span class="fl">190.1</span>,<span class="fl">183.0</span>,<span class="fl">174.2</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight=</span><span class="fu">c</span>(<span class="fl">50.5</span>,<span class="fl">56.3</span>,<span class="fl">68.0</span>,<span class="fl">75.1</span>,<span class="fl">65.9</span>,<span class="fl">55.4</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co">#use is.numeric() to identify numerical data</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>resb<span class="ot">&lt;-</span><span class="fu">vapply</span>(oribnum,is.numeric,<span class="at">FUN.VALUE=</span><span class="fu">logical</span>(<span class="dv">1</span>))</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co">#use vapply to compute the standard deviation of numerical columns</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(oribnum[resb],sd,<span class="at">FUN.VALUE=</span><span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##    height    weight 
## 10.154687  9.284539</code></pre>
<p><br />
(2)Excecises 7:<br />
Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(),a parallel version of vapply()? Why or why not?<br />
</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parallel)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the number of computer cores</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">&lt;-</span> <span class="fu">detectCores</span>(<span class="at">logical =</span> <span class="cn">FALSE</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">#use parSapply in parallel to generate mcsapply</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>mcsapply<span class="ot">&lt;-</span><span class="cf">function</span>(x,f){</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  coresnum<span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">3</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  median_res<span class="ot">&lt;-</span><span class="fu">parSapply</span>(coresnum,x,f)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopCluster</span>(coresnum)</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(median_res)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>ttestdata<span class="ot">&lt;-</span><span class="fu">replicate</span>(<span class="dv">10000</span>,<span class="fu">t.test</span>(<span class="fu">rnorm</span>(<span class="dv">20</span>,<span class="dv">1</span>,<span class="dv">11</span>), <span class="fu">runif</span>(<span class="dv">30</span>)),<span class="at">simplify=</span><span class="cn">FALSE</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">mcsapply</span>(ttestdata,<span class="cf">function</span>(x) <span class="fu">unlist</span>(x)))</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(<span class="fu">sapply</span>(ttestdata,<span class="cf">function</span>(x) <span class="fu">unlist</span>(x)))</span></code></pre></div>
<p>从用户时间可以看出，使用mscapply进行计算的运行时间明显短于使用sapply函数。<br />
我认为mvapply同样可以类似构造进行应用。<br />
<br />
—————————2021-12-02———————————–<br />
<br />
## QUESTION</p>
<p>Write an Rcpp function for Exercise 9.8 (page 278, Statistical Computing with R).<br />
Compare the corresponding generated random numbers with pure R language using the function “qqplot”.<br />
Campare the computation time of the two functions with the function “microbenchmark”.<br />
Comments your results.</p>
</div>
<div id="answer-5" class="section level2">
<h2>ANSWER</h2>
<p><br />
Exercise 9.8:This example appears in [40]. Consider the bivariate density <span class="math display">\[f(x,y)\propto{C_{n}^{x}y^{x+a-1}(1-y)^{n-x+b-1},x=0,1,…,n,0\leq{y}\leq{1}}\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a,b,n\)</span>, the conditional distributions are <span class="math inline">\(Binomial(n,y)\)</span> and <span class="math inline">\(Beta(x+a,n-x+b)\)</span>. Use the Gibbs sampler to generate a chain with target joint density f(x,y).</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cppFunction</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="st">&#39;NumericMatrix Mygibbs(double x,double y,int N) {</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="st">  NumericMatrix GX(2,N);</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="st">  int a=2,b=2,n=10;</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="st">  GX(0,0)=x;</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="st">  GX(1,0)=y;  </span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="st">    double x0=GX(0,i-1);</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="st">    GX(1,i)=rbeta(1,x0+a,n-x0+b)[0];</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="st">    double y0=GX(1,i);</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="st">    GX(0,i)=rbinom(1,n,y0)[0];</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="st">  return GX;</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="st">}&#39;</span>)</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>GX_cpp<span class="ot">&lt;-</span><span class="fu">Mygibbs</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1000</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>GXfunc<span class="ot">&lt;-</span><span class="cf">function</span>(ori,N){</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>   GbN<span class="ot">&lt;-</span>N</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>   GX<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol=</span>GbN,<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>   GX[,<span class="dv">1</span>]<span class="ot">&lt;-</span>ori</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>GbN){</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span>GX[,i<span class="dv">-1</span>][<span class="dv">1</span>]</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  GX[,i][<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1</span>,<span class="at">shape1=</span>x<span class="sc">+</span>a,<span class="at">shape2=</span>n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span>GX[,i][<span class="dv">2</span>]</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  GX[,i][<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="at">size=</span>n,<span class="at">prob=</span>y)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(GX)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>GXori<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>)</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>GX_r<span class="ot">&lt;-</span><span class="fu">GXfunc</span>(GXori,<span class="dv">1000</span>)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(GX_cpp[<span class="dv">1</span>,],GX_r[<span class="dv">1</span>,])</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(GX_cpp[<span class="dv">2</span>,],GX_r[<span class="dv">2</span>,])</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">Gibbs1=</span><span class="fu">Mygibbs</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="dv">1000</span>),<span class="at">Gibbs2=</span><span class="fu">GXfunc</span>(GXori,<span class="dv">1000</span>))</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<p>可以看出，使用cppFunction进行计算，计算速度大大降低。并且，从qqplot图来看，得出随机数十分接近。</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
